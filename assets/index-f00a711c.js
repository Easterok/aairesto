import{_ as U}from"./index-127a01d9.js";import{d as j,m as q,r as d,Q as N,b as $,w as D,c as n,a as s,j as h,h as C,i as x,k as r,F as k,g as T,n as y,l as E,u as G,o as l,G as H,ar as Q,as as I,t as z,q as _,S as A,_ as J}from"./index-2ac84a6d.js";import{R as K}from"./index-93bac8a8.js";import{T as B}from"./index-2dcd8634.js";import{T as O}from"./index-03765aec.js";const W=new Array(6).fill("").map((V,u)=>({id:`-${u}`,number:`${u}`,zone:"Зал 2 этаж",active:!0,capacity:2,is_reservable:!0})),X=s("h6",{class:"ark-text_h6 ark-space_bottom-1"},"Активные зоны",-1),Y={class:"ark-text_body-s ark-space_bottom-4 ark-text_64"},ee=s("p",null,[h(' К примеру, ресторан имеет "Летник", который работает только в летний период. '),s("br"),s("br"),h(" Вы можете отключить эту зону, если пошел сильный дождь."),s("br"),h("Приложение перестанет предлагать столы из этой зоны и пересчитает время ожидания ")],-1),ae=["for"],te={class:"ark-text_body-xs ark-text_64"},se={key:1,style:{"text-align":"center",width:"100%"}},le=s("img",{src:U,width:"128",height:"128",alt:"No zones",class:"ark-space_bottom-4"},null,-1),oe=s("h3",{class:"ark-space_bottom-6 ark-text_h5"},"Зоны не найдены",-1),ne=[le,oe],re=s("h6",{class:"ark-text_h6 ark-space_top-8 ark-space_bottom-1"},"Столы",-1),ce=s("p",{class:"ark-text_body-s ark-space_bottom-4 ark-text_64"}," Управляйте столами ресторана ",-1),ue={key:0,style:{display:"flex","flex-wrap":"wrap"}},ie=["for"],de={key:1,style:{"text-align":"center",width:"100%"}},_e=s("img",{src:U,width:"128",height:"128",alt:"No zones",class:"ark-space_bottom-4"},null,-1),he=s("h3",{class:"ark-space_bottom-6 ark-text_h5"},"Зоны не найдены",-1),pe=[_e,he],be=j({__name:"Zone",props:{id:{}},setup(V){const u=V,p=G(),c=q(),b=d([]),m=d(!1),i=d([]),f=d(null),v=d(!1),g=N({}),w=N({}),F=new Array(3).fill("").map((a,t)=>({id:-t,active:!1,zone:"stub"})),S=$(()=>m.value?F:b.value),R=$(()=>{const a=i.value.map(({zone:t})=>t);return[null,...Array.from(new Set(a)).sort()]}),Z=$(()=>{if(v.value)return W;const a=f.value,t=[...i.value].sort((e,o)=>Number(e.number)-Number(o.number));return a?t.filter(e=>e.zone===a):t}),L=(a,t,e)=>{w[t]=!0,p.updateZoneSchedule.execute({restId:u.id,active:a,zoneId:`${t}`}).then(()=>{c.show(`${e} ${a?"включена":"отключена"}`),b.value=b.value.map(o=>o.id===t?{...o,active:a}:o)}).catch(()=>{c.show("Попробуйте еще раз",{type:"error",label:`Ошибка ${a?"включения":"отключения"} зоны ${e}`})}).finally(()=>{w[t]=!1})},M=(a,t)=>{g[t.id]=!0,p.updateTableSetting.execute({id:t.id,active:a,capacity:t.capacity}).then(()=>{i.value=i.value.map(e=>e.id===t.id?{...e,active:a}:e),c.show(`Стол ${t.number} обновлен`,{autoClose:1e3})}).catch(()=>{c.show("Попробуйте еще раз",{type:"error",label:`Не удалось обновить стол ${t.number}`})}).finally(()=>{g[t.id]=!1})};return D(()=>u.id,a=>{m.value=!0,p.loadZonesSchedule.execute({id:a}).then(t=>{b.value=t??[]}).catch(()=>{c.show("Попробуйте перезагрузить страницу",{type:"error",label:"Ошибка загрузки зон"})}).finally(()=>{m.value=!1}),(a==="111171"||a==="111170")&&(v.value=!0,p.loadTablesForSettings.execute({restaurant_code:a}).then(t=>{i.value=t??[]}).catch(()=>{c.show("Попробуйте перезагрузить страницу",{type:"error",label:"Ошибка загрузки столов"})}).finally(()=>{v.value=!1}))},{immediate:!0}),(a,t)=>(l(),n("div",{class:y(a.$style.container)},[X,s("p",Y,[h(" Управляйте активностью зон, которые имеют "),C(r(I),null,{default:x(({on:e,attrs:o})=>[s("span",H({class:a.$style.hintText},o,Q(e,!0))," уникальное расписание ",16)]),hint:x(()=>[ee]),_:1})]),S.value.length>0?(l(!0),n(k,{key:0},T(S.value,e=>(l(),n("label",{key:e.id,class:y([a.$style.label,m.value&&"ark-skeleton"]),for:`${e.id}`},[s("div",null,[s("p",null,z(e.zone),1),s("p",te,z(e.active?"Включена":"Отключена"),1)]),w[e.id]?(l(),_(r(A),{key:1,name:"spinner",size:24})):(l(),_(r(B),{key:0,id:`${e.id}`,size:"m","model-value":e.active,"onUpdate:modelValue":o=>L(o,e.id,e.zone)},null,8,["id","model-value","onUpdate:modelValue"]))],10,ae))),128)):(l(),n("div",se,ne)),a.id==="111170"||a.id==="111171"?(l(),n(k,{key:2},[re,ce,s("div",{class:y(["ark-space_bottom-4",a.$style.statuses])},[(l(!0),n(k,null,T(R.value,(e,o)=>(l(),_(r(K),{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=P=>f.value=P),key:o,"hide-radio":"",size:"s",style:{"--ark-background-color":"var(--ark-text-color-08)","white-space":"nowrap"},name:"ReservationsStatus",item:e},{default:x(()=>[h(z(e??"Все"),1)]),_:2},1032,["modelValue","item"]))),128))],2),Z.value.length>0?(l(),n("div",ue,[(l(!0),n(k,null,T(Z.value,e=>(l(),n("label",{key:e.id,class:y([a.$style.label,a.$style.label_half,v.value&&"ark-skeleton"]),for:`table_${e.id}`},[s("div",null,[C(r(O),{size:"m",item:e},null,8,["item"])]),g[e.id]?(l(),_(r(A),{key:1,name:"spinner",size:24})):(l(),_(r(B),{key:0,id:`table_${e.id}`,size:"m","model-value":e.active,"onUpdate:modelValue":o=>M(o,e)},null,8,["id","model-value","onUpdate:modelValue"]))],10,ie))),128))])):(l(),n("div",de,pe))],64)):E("",!0)],2))}}),me="_container_1te6c_1",ve="_label_1te6c_7",ke="_label_half_1te6c_23",ye="_hintText_1te6c_39",fe="_statuses_1te6c_44",ge={container:me,label:ve,label_half:ke,hintText:ye,statuses:fe},we={$style:ge},Se=J(be,[["__cssModules",we]]);export{Se as default};
