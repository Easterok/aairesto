import{d as q,u as E,r as y,b as C,e as w,M as B,f as L,w as O,o as a,c as l,F as M,g as x,n as t,h as k,i as m,S as $,j as S,t as v,k as f,_ as b,l as D,m as J,a as i,p as V,q as I,s as F,v as A,x as H}from"./index-6367d8ff.js";import{_ as R}from"./index-127a01d9.js";import{E as j,s as T}from"./index-cfb8160a.js";import{r as U}from"./index-146507eb.js";const G=q({__name:"LoadEta",props:{code:{}},setup(N){const h=N,g=E(),p=y(NaN),r=y(null),c=C(()=>(r.value||[]).filter(o=>o.num_people===2||o.num_people===4||o.num_people===6));let u=null;return w(()=>{u=setInterval(()=>{p.value=Date.now()},B*60)}),L(()=>{u&&clearInterval(u)}),O([()=>h.code,p],([_])=>{g.loadEta.execute({id:_}).then(o=>{r.value=o}).catch(()=>null)},{immediate:!0}),(_,o)=>c.value?(a(),l("div",{key:0,class:t(_.$style.eta)},[(a(!0),l(M,null,x(c.value,d=>(a(),l("div",{key:d.num_people,class:t(_.$style.eta__item)},[k(m($),{name:"users",class:"ark-space_right-1",size:12}),S(v(d.num_people)+" ~",1),k(j,{date:d.time_difference_minutes},null,8,["date"])],2))),128))],2)):f("",!0)}}),K={$style:T},P=b(G,[["__cssModules",K]]),Q=["alt","src"],W={key:1,style:{"text-align":"center",width:"100%"}},X=i("img",{src:R,width:"128",height:"128",alt:"No users",class:"ark-space_bottom-4"},null,-1),Y=i("h3",{class:"ark-space_bottom-6 ark-text_h5"},"Нет ресторанов :(",-1),Z=[X,Y],ee=q({__name:"Home",setup(N){const h=E(),g=D(),p=y([]),r=y(!1),c=J({}),u=()=>{let e=[];try{e=JSON.parse(localStorage.getItem("__airesto-fav-rests")||"[]"),e=e.filter(n=>typeof n=="number")}catch{}return e},_=u();_.forEach(e=>{c[e]=!0});const o=C(()=>r.value?U:[...p.value].sort(n=>_.includes(n.code)?-1:1)),d=e=>{c[e]=!c[e],c[e]?localStorage.setItem("__airesto-fav-rests",JSON.stringify(u().concat(e))):localStorage.setItem("__airesto-fav-rests",JSON.stringify(u().filter(n=>n!=e)))};return w(()=>{r.value=!0,h.loadRestaurants.execute().then(e=>{p.value=e||[]}).catch(([e,n])=>{n!==403&&g.show("Не удалось загрузить рестораны",{type:"error"})}).finally(()=>{r.value=!1})}),(e,n)=>{const z=V("router-link");return a(),l("div",{class:t(["ark-container ark-space_vertical-4",e.$style.items])},[o.value.length>0?(a(!0),l(M,{key:0},x(o.value,s=>(a(),I(z,{key:s.code,to:`/restaurant/${s.code}`,class:t([e.$style.rest,r.value&&"ark-skeleton"])},{default:F(()=>[r.value?f("",!0):(a(),l("div",{key:0,class:t(e.$style.rest__surface)},[s.link_to_image?(a(),l("img",{key:0,alt:s.name,src:s.link_to_image},null,8,Q)):f("",!0),i("h5",{class:t(["ark-text_h5",e.$style.rest__name])},v(s.name),3)],2)),i("div",{class:t(e.$style.rest__content)},[i("p",{class:t(e.$style.rest__text)},[k(m($),{class:"ark-space_right-2",name:"address",size:16}),S(" "+v(s.address),1)],2),i("p",{class:t(e.$style.rest__text)},[k(m($),{class:"ark-space_right-2",name:"clock",size:16}),S(" "+v(s.opening_time)+" - "+v(s.closing_time),1)],2),r.value?f("",!0):(a(),I(m(P),{key:0,code:s.code},null,8,["code"]))],2),r.value?f("",!0):(a(),l("div",{key:1,class:t(e.$style.fav)},[k(m(H),{icon:"star",appearance:"dark-2",shape:"square",size:"s",class:t(c[s.code]&&e.$style.fav__active),onClick:A(ie=>d(s.code),["stop","prevent"])},null,8,["class","onClick"])],2))]),_:2},1032,["to","class"]))),128)):(a(),l("div",W,Z))],2)}}}),se="_items_1kpqt_1",te="_rest_1kpqt_7",ae="_rest__name_1kpqt_22",re="_rest__content_1kpqt_31",oe="_fav_1kpqt_44",ne="_rest__surface_1kpqt_61",le="_rest__text_1kpqt_81",ce="_fav__active_1kpqt_96",_e={items:se,rest:te,rest__name:ae,rest__content:re,fav:oe,rest__surface:ne,rest__text:le,fav__active:ce},ue={$style:_e},fe=b(ee,[["__cssModules",ue]]);export{fe as default};
