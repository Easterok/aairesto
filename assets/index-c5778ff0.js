import{d as V,l as w,w as g,r as x,c as k,h as s,s as n,i as a,a as u,n as b,v as C,p as E,u as S,y as $,o as z,B,j as p,x as N,_ as U}from"./index-6367d8ff.js";import{_}from"./index-bbe23418.js";import{I as A}from"./index-89d72c36.js";import{c as M,r as d,e as j}from"./index-9268c079.js";import"./index-55204b2b.js";const q=u("h6",{class:"ark-text_h6 ark-space_bottom-4"},"Регистрация",-1),I={class:"ark-space_bottom-6"},P=V({__name:"Signup",setup(O){const m=S(),f=w(),v=$(),e=M({email:["",{required:d,email:j}],password:["",{required:d}]}),h={"A user with that email already exists.":"Пользователь с такой почтой уже существует"};g([e.email.value,e.password.value],()=>{e.email.removeErrors(["_async"]),e.password.removeErrors(["_async"])});const i=x(!1),y=()=>{if(e.validate(),e.invalid.value)return;i.value=!0;const l=e.getCurrentValue();m.signup.execute(l).catch(([o])=>{if(o.email&&o.email[0]){const r=o.email[0];e.email.setErrors({_async:h[r]||r})}else f.show(JSON.stringify(o),{type:"error",label:"Ошибка регистрации"});return Promise.reject(null)}).then(()=>m.login(l)).then(()=>v.push("/")).finally(()=>{i.value=!1})};return(l,o)=>{const r=E("router-link");return z(),k("form",{class:b(l.$style.form),onSubmit:C(y,["prevent"])},[q,s(a(_),{class:"ark-space_bottom-3",control:a(e).email},{default:n(({model:t})=>[s(a(B),{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,placeholder:"Email",autocomplete:"email",name:"email",inputmode:"email",size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),s(a(_),{class:"ark-space_bottom-1",control:a(e).password},{default:n(({model:t})=>[s(a(A),{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,placeholder:"Пароль",size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),u("p",I,[s(r,{to:"/login"},{default:n(()=>[p("Авторизация")]),_:1})]),u("div",null,[s(a(N),{type:"submit",size:"l",loading:i.value},{default:n(()=>[p(" Зарегистрироваться ")]),_:1},8,["loading"])])],34)}}}),R="_form_1tlxv_1",F={form:R},J={$style:F},L=U(P,[["__cssModules",J]]);export{L as default};
