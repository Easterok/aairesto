import{_ as B}from"./index-127a01d9.js";import{d as P,l as j,r as d,m as Z,b as w,w as q,c as n,a as s,j as _,h as N,s as x,i as r,F as k,g as $,n as v,k as D,u as E,o,H as G,aU as I,aV as J,t as T,q as i,S as C,_ as K}from"./index-0b86611f.js";import{R as O}from"./index-136ba457.js";import{T as U}from"./index-80d71df4.js";import{T as Q}from"./index-7b81d4fd.js";import{m as W}from"./index-dee5c87c.js";/* empty css              */const X=s("h6",{class:"ark-text_h6 ark-space_bottom-1"},"Активные зоны",-1),Y={class:"ark-text_body-s ark-space_bottom-4 ark-text_64"},ee=s("p",null,[_(' К примеру, ресторан имеет "Летник", который работает только в летний период. '),s("br"),s("br"),_(" Вы можете отключить эту зону, если пошел сильный дождь."),s("br"),_("Приложение перестанет предлагать столы из этой зоны и пересчитает время ожидания ")],-1),ae=["for"],te={class:"ark-text_body-xs ark-text_64"},se={key:1,style:{"text-align":"center",width:"100%"}},oe=s("img",{src:B,width:"128",height:"128",alt:"No zones",class:"ark-space_bottom-4"},null,-1),le=s("h3",{class:"ark-space_bottom-6 ark-text_h5"},"Зоны не найдены",-1),ne=[oe,le],re=s("h6",{class:"ark-text_h6 ark-space_top-8 ark-space_bottom-1"},"Столы",-1),ce=s("p",{class:"ark-text_body-s ark-space_bottom-4 ark-text_64"}," Управляйте столами ресторана ",-1),ue={key:0,style:{display:"flex","flex-wrap":"wrap"}},de=["for"],ie={key:1,style:{"text-align":"center",width:"100%"}},_e=s("img",{src:B,width:"128",height:"128",alt:"No zones",class:"ark-space_bottom-4"},null,-1),he=s("h3",{class:"ark-space_bottom-6 ark-text_h5"},"Зоны не найдены",-1),pe=[_e,he],be=P({__name:"Zone",props:{id:{}},setup(A){const z=A,h=E(),c=j(),p=d([]),b=d(!1),u=d([]),f=d(null),m=d(!1),y=Z({}),g=Z({}),F=new Array(3).fill("").map((a,t)=>({id:-t,active:!1,zone:"stub"})),V=w(()=>b.value?F:p.value),R=w(()=>{const a=u.value.map(({zone:t})=>t);return[null,...Array.from(new Set(a)).sort()]}),S=w(()=>{if(m.value)return W;const a=f.value,t=[...u.value].sort((e,l)=>Number(e.number)-Number(l.number));return a?t.filter(e=>e.zone===a):t}),H=(a,t,e)=>{g[t]=!0,h.updateZoneSchedule.execute({restId:z.id,active:a,zoneId:`${t}`}).then(()=>{c.show(`${e} ${a?"включена":"отключена"}`),p.value=p.value.map(l=>l.id===t?{...l,active:a}:l)}).catch(()=>{c.show("Попробуйте еще раз",{type:"error",label:`Ошибка ${a?"включения":"отключения"} зоны ${e}`})}).finally(()=>{g[t]=!1})},L=(a,t)=>{y[t.id]=!0,h.updateTableSetting.execute({id:t.id,active:a,capacity:t.capacity}).then(()=>{u.value=u.value.map(e=>e.id===t.id?{...e,active:a}:e),c.show(`Стол ${t.number} обновлен`,{autoClose:1e3})}).catch(()=>{c.show("Попробуйте еще раз",{type:"error",label:`Не удалось обновить стол ${t.number}`})}).finally(()=>{y[t.id]=!1})};return q(()=>z.id,a=>{b.value=!0,h.loadZonesSchedule.execute({id:a}).then(t=>{p.value=t??[]}).catch(()=>{c.show("Попробуйте перезагрузить страницу",{type:"error",label:"Ошибка загрузки зон"})}).finally(()=>{b.value=!1}),(a==="111171"||a==="111170"||a==="111113")&&(m.value=!0,h.loadTablesForSettings.execute({restaurant_code:a}).then(t=>{u.value=t??[]}).catch(()=>{c.show("Попробуйте перезагрузить страницу",{type:"error",label:"Ошибка загрузки столов"})}).finally(()=>{m.value=!1}))},{immediate:!0}),(a,t)=>(o(),n("div",{class:v(a.$style.container)},[X,s("p",Y,[_(" Управляйте активностью зон, которые имеют "),N(r(J),null,{default:x(({on:e,attrs:l})=>[s("span",G({class:a.$style.hintText},l,I(e,!0))," уникальное расписание ",16)]),hint:x(()=>[ee]),_:1})]),V.value.length>0?(o(!0),n(k,{key:0},$(V.value,e=>(o(),n("label",{key:e.id,class:v([a.$style.label,b.value&&"ark-skeleton"]),for:`${e.id}`},[s("div",null,[s("p",null,T(e.zone),1),s("p",te,T(e.active?"Включена":"Отключена"),1)]),g[e.id]?(o(),i(r(C),{key:1,name:"spinner",size:24})):(o(),i(r(U),{key:0,id:`${e.id}`,size:"m","model-value":e.active,"onUpdate:modelValue":l=>H(l,e.id,e.zone)},null,8,["id","model-value","onUpdate:modelValue"]))],10,ae))),128)):(o(),n("div",se,ne)),a.id==="111170"||a.id==="111171"||a.id==="111113"?(o(),n(k,{key:2},[re,ce,s("div",{class:v(["ark-space_bottom-4",a.$style.statuses])},[(o(!0),n(k,null,$(R.value,(e,l)=>(o(),i(r(O),{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=M=>f.value=M),key:l,"hide-radio":"",size:"s",style:{"--ark-background-color":"var(--ark-text-color-08)","white-space":"nowrap"},name:"ReservationsStatus",item:e},{default:x(()=>[_(T(e??"Все"),1)]),_:2},1032,["modelValue","item"]))),128))],2),S.value.length>0?(o(),n("div",ue,[(o(!0),n(k,null,$(S.value,e=>(o(),n("label",{key:e.id,class:v([a.$style.label,a.$style.label_half,m.value&&"ark-skeleton"]),for:`table_${e.id}`},[s("div",null,[N(r(Q),{size:"m",item:e},null,8,["item"])]),y[e.id]?(o(),i(r(C),{key:1,name:"spinner",size:24})):(o(),i(r(U),{key:0,id:`table_${e.id}`,size:"m","model-value":e.active,"onUpdate:modelValue":l=>L(l,e)},null,8,["id","model-value","onUpdate:modelValue"]))],10,de))),128))])):(o(),n("div",ie,pe))],64)):D("",!0)],2))}}),me="_container_1te6c_1",ke="_label_1te6c_7",ve="_label_half_1te6c_23",fe="_hintText_1te6c_39",ye="_statuses_1te6c_44",ge={container:me,label:ke,label_half:ve,hintText:fe,statuses:ye},we={$style:ge},Ne=K(be,[["__cssModules",we]]);export{Ne as default};
