import{_ as S}from"./index-127a01d9.js";import{R as V}from"./index-136ba457.js";import{T as $}from"./index-80d71df4.js";import{d as N,l as B,r as p,m as C,b as v,w as A,c as l,a as o,F as m,g as k,n as y,u as F,o as s,q as b,s as R,j as U,t as M,i as u,h as Z,S as j,_ as q}from"./index-0b86611f.js";import{T as D}from"./index-7b81d4fd.js";import{m as E}from"./index-dee5c87c.js";/* empty css              */const I=o("h4",{class:"ark-text_h4 ark-space_bottom-1"},"Столы",-1),L=o("p",{class:"ark-space_bottom-4 ark-text_body-s"},"Управляйте столами ресторана",-1),P={key:0,style:{display:"flex","flex-wrap":"wrap"}},G=["for"],H={key:1,style:{"text-align":"center",width:"100%"}},J=o("img",{src:S,width:"128",height:"128",alt:"No zones",class:"ark-space_bottom-4"},null,-1),K=o("h3",{class:"ark-space_bottom-6 ark-text_h5"},"Зоны не найдены",-1),O=[J,K],Q=N({__name:"Tables",props:{id:{}},setup(g){const T=g,h=F(),i=B(),r=p([]),c=p(!1),d=p(null),_=C({}),w=v(()=>{const t=r.value.map(({zone:a})=>a);return[null,...Array.from(new Set(t)).sort()]}),f=v(()=>{if(c.value)return E;const t=d.value,a=[...r.value].sort((e,n)=>Number(e.number)-Number(n.number));return t?a.filter(e=>e.zone===t):a}),x=(t,a)=>{_[a.id]=!0,h.updateTableSetting.execute({id:a.id,active:t,capacity:a.capacity}).then(()=>{r.value=r.value.map(e=>e.id===a.id?{...e,active:t}:e),i.show(`Стол ${a.number} обновлен`,{autoClose:1e3})}).catch(()=>{i.show("Попробуйте еще раз",{type:"error",label:`Не удалось обновить стол ${a.number}`})}).finally(()=>{_[a.id]=!1})};return A(()=>T.id,t=>{(t==="111171"||t==="111170"||t==="111113")&&(c.value=!0,h.loadTablesForSettings.execute({restaurant_code:t}).then(a=>{r.value=a??[]}).catch(()=>{i.show("Попробуйте перезагрузить страницу",{type:"error",label:"Ошибка загрузки столов"})}).finally(()=>{c.value=!1}))},{immediate:!0}),(t,a)=>(s(),l(m,null,[I,L,o("div",{class:y(["ark-space_bottom-4",t.$style.statuses])},[(s(!0),l(m,null,k(w.value,(e,n)=>(s(),b(u(V),{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=z=>d.value=z),key:n,"hide-radio":"",size:"s",style:{"--ark-background-color":"var(--ark-text-color-08)","white-space":"nowrap"},name:"ReservationsStatus",item:e},{default:R(()=>[U(M(e??"Все"),1)]),_:2},1032,["modelValue","item"]))),128))],2),f.value.length>0?(s(),l("div",P,[(s(!0),l(m,null,k(f.value,e=>(s(),l("label",{key:e.id,class:y([t.$style.label,t.$style.label_half,c.value&&"ark-skeleton"]),for:`table_${e.id}`},[o("div",null,[Z(u(D),{size:"m",item:e},null,8,["item"])]),_[e.id]?(s(),b(u(j),{key:1,name:"spinner",size:24})):(s(),b(u($),{key:0,id:`table_${e.id}`,size:"m","model-value":e.active,"onUpdate:modelValue":n=>x(n,e)},null,8,["id","model-value","onUpdate:modelValue"]))],10,G))),128))])):(s(),l("div",H,O))],64))}}),W="_container_1te6c_1",X="_label_1te6c_7",Y="_label_half_1te6c_23",ee="_hintText_1te6c_39",ae="_statuses_1te6c_44",te={container:W,label:X,label_half:Y,hintText:ee,statuses:ae},se={$style:te},de=q(Q,[["__cssModules",se]]);export{de as default};
