import{a_ as j,aZ as F}from"./index-45eddc23.js";const V=new Date("0001-01-01"),U=new Date("9999-12-31"),T=" ",O="–",L="—",w="-",N="−",Y=[w,O,L,N],z=[":","."];function b(e,n,t){const r=Math.min(Number(t),Math.max(Number(n),Number(e)));return e instanceof Date?new Date(r):r}const W=e=>{var n,t,r;return{day:((n=e.match(/d/g))===null||n===void 0?void 0:n.length)||0,month:((t=e.match(/m/g))===null||t===void 0?void 0:t.length)||0,year:((r=e.match(/y/g))===null||r===void 0?void 0:r.length)||0}};function X(e){return{day:String(e.getDate()).padStart(2,"0"),month:String(e.getMonth()+1).padStart(2,"0"),year:String(e.getFullYear()).padStart(4,"0"),hours:String(e.getHours()).padStart(2,"0"),minutes:String(e.getMinutes()).padStart(2,"0"),seconds:String(e.getSeconds()).padStart(2,"0"),milliseconds:String(e.getMilliseconds()).padStart(3,"0")}}function K(e,n){return e.length<n.length?!1:e.split(/\D/).every(t=>!t.match(/^0+$/))}function k(e,n,t){const r=n.replace(/\W/g,"").length;return e.replace(t,"").match(new RegExp(`(\\D*\\d[^\\d\\s]*){1,${r}}`,"g"))||[]}function B(e){return e.reduce((n,[t,r])=>Object.assign(Object.assign({},n),{[t]:r}),{})}function H(e,n){const t=n.replace(/[^dmy]/g,""),r=e.replace(/\D+/g,""),s={day:r.slice(t.indexOf("d"),t.lastIndexOf("d")+1),month:r.slice(t.indexOf("m"),t.lastIndexOf("m")+1),year:r.slice(t.indexOf("y"),t.lastIndexOf("y")+1)};return B(Object.entries(s).filter(([o,i])=>!!i).sort(([o],[i])=>n.toLowerCase().indexOf(o[0])>n.toLowerCase().indexOf(i[0])?1:-1))}function q(e,n){var t,r,s,o,i,c,u;const l=((t=e.year)===null||t===void 0?void 0:t.length)===2?`20${e.year}`:e.year,a=new Date(Number(l??"0"),Number((r=e.month)!==null&&r!==void 0?r:"1")-1,Number((s=e.day)!==null&&s!==void 0?s:"1"),Number((o=n==null?void 0:n.hours)!==null&&o!==void 0?o:"0"),Number((i=n==null?void 0:n.minutes)!==null&&i!==void 0?i:"0"),Number((c=n==null?void 0:n.seconds)!==null&&c!==void 0?c:"0"),Number((u=n==null?void 0:n.milliseconds)!==null&&u!==void 0?u:"0"));return a.setFullYear(Number(l??"0")),a}const J=", ";function x({day:e,month:n,year:t,hours:r,minutes:s,seconds:o,milliseconds:i},c,u){var l;const a=((l=c.match(/y/g))===null||l===void 0?void 0:l.length)===2?t==null?void 0:t.slice(-2):t;return(c+(u?J+u:"")).replace(/d+/g,e??"").replace(/m+/g,n??"").replace(/y+/g,a??"").replace(/H+/g,r??"").replace(/MSS/g,i??"").replace(/M+/g,s??"").replace(/S+/g,o??"").replace(/^\D+/g,"").replace(/\D+$/g,"")}function A(e,n,t=0){return Number(e.padEnd(n.length,"0"))<=Number(n)?{validatedSegmentValue:e,prefixedZeroesCount:t}:e.endsWith("0")?A(`0${e.slice(0,n.length-1)}`,n,t+1):A(`${e.slice(0,n.length-1)}0`,n,t)}const Q={day:31,month:12,year:9999};function ee({dateString:e,dateModeTemplate:n,offset:t,selection:[r,s]}){const o=H(e,n),i=Object.entries(o),c={};let u=0;for(const[g,d]of i){const f=x(c,n),p=Q[g],m=f.length&&1,h=t+f.length+m+W(n)[g],D=h>=r&&h===s;if(D&&Number(d)>Number(p))return{validatedDateString:"",updatedSelection:[r,s]};if(D&&Number(d)<1)return{validatedDateString:"",updatedSelection:[r,s]};const{validatedSegmentValue:E,prefixedZeroesCount:$}=A(d,`${p}`);u+=$,c[g]=E}const l=x(c,n),a=l.length-e.length;return{validatedDateString:l,updatedSelection:[r+u+a,s+u+a]}}const Z=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(Z.source);function v(e){return e&&ne.test(e)?e.replace(Z,"\\$&"):e}function te(e,n){let t="";for(let r=0;r<e.length;r++){if(e[r]!==n[r])return t;t+=e[r]}return t}function re({activeElement:e}){if(!(e!=null&&e.shadowRoot))return e;let n=e.shadowRoot.activeElement;for(;n!=null&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function P(e){return e}function se(e,n){const t=W(n);return B(Object.entries(e).map(([r,s])=>{const o=t[r];return[r,s.length===o&&s.match(/^0+$/)?"1".padStart(o,"0"):s]}))}function oe({dateModeTemplate:e,min:n=V,max:t=U,rangeSeparator:r="",dateSegmentSeparator:s="."}){return({value:o,selection:i})=>{const c=r&&o.endsWith(r),u=k(o,e,r);let l="";for(const a of u){l+=l?r:"";const g=H(a,e);if(!K(a,e)){const p=se(g,e),m=x(p,e),h=a.endsWith(s)?s:"";l+=m+h;continue}const d=q(g),f=b(d,n,t);l+=x(X(f),e)}return{selection:i,value:l+(c?r:"")}}}function ie(e){const n=new RegExp(`${v(e)}$`);return e?({value:t,selection:r},s)=>{if(!t&&!s.value.endsWith(e))return{value:t,selection:r};if(!t.endsWith(e)&&!s.value.endsWith(e))return{selection:r,value:t+e};const o=s.value.replace(n,""),i=s.selection[1]>=o.length,c=te(o,t);return{selection:r,value:Array.from(e).reverse().reduce((u,l,a)=>{const g=u.length-1-a,d=c[g]===l&&i;return u[g]!==l||d?u.slice(0,g+1)+l+u.slice(g+1):u},t)}}:P}function ce(e){return e?({value:n,selection:t},r)=>{if(n.startsWith(e)||!n&&!r.value.startsWith(e))return{value:n,selection:t};const[s,o]=t,i=Array.from(e).reduce((c,u,l)=>(c+n)[l]===u?c:c+u,"");return{selection:[s+i.length,o+i.length],value:i+n}}:P}function ue({dateModeTemplate:e,dateSegmentsSeparator:n,rangeSeparator:t=""}){return({elementState:r,data:s})=>{const{value:o,selection:i}=r;if(s===n)return{elementState:r,data:i[0]===o.length?s:""};if(Y.includes(s))return{elementState:r,data:t};const c=s.replace(new RegExp(`[^\\d${v(n)}${t}]`,"g"),"");if(!c)return{elementState:r,data:""};const[u,l]=i;let a=l+s.length;const g=o.slice(0,u)+c+o.slice(a),d=k(g,e,t);let f="";const p=!!t&&g.includes(t);for(const h of d){const{validatedDateString:D,updatedSelection:E}=ee({dateString:h,dateModeTemplate:e,offset:f?f.length+t.length:0,selection:[u,a]});if(h&&!D)return{elementState:r,data:""};a=E[1],f+=p&&f?t+D:D}const m=f.slice(u,a);return{elementState:{selection:i,value:f.slice(0,u)+m.split(n).map(h=>"0".repeat(h.length)).join(n)+f.slice(a)},data:m}}}function _e(e){return n=>{const t=n.ownerDocument;let r=0;const s=()=>r++,o=()=>r--,i=()=>{if(re(t)!==n)return;if(r)return t.addEventListener("mouseup",i,{once:!0,passive:!0});const c=n.selectionStart||0,u=n.selectionEnd||0,[l,a]=e(n.value,[c,u]);(l>c||a<u)&&n.setSelectionRange(b(c,l,a),b(u,l,a))};return t.addEventListener("selectionchange",i,{passive:!0}),t.addEventListener("mousedown",s,{passive:!0}),t.addEventListener("mouseup",o,{passive:!0}),()=>{t.removeEventListener("selectionchange",i),t.removeEventListener("mousedown",s),t.removeEventListener("mouseup",o)}}}function I(e,n,t){return(r,s)=>{const o=()=>n(r,s);return r.addEventListener(e,o,t),()=>r.removeEventListener(e,o,t)}}function le(){return({elementState:e},n)=>{const{value:t,selection:r}=e;if(!t||ae(t,r))return{elementState:e};const[s,o]=r,i=t.slice(s,o).replace(/\d/g,"0"),c=t.slice(0,s)+i+t.slice(o);return n==="validation"||n==="insert"&&s===o?{elementState:{selection:r,value:c}}:{elementState:{selection:n==="deleteBackward"||n==="insert"?[s,s]:[o,o],value:c}}}}function ae(e,[n,t]){return t===e.length}function Ae({mode:e,separator:n=".",max:t,min:r}){const s=e.split("/").join(n);return Object.assign(Object.assign({},j),{mask:Array.from(s).map(o=>o===n?o:/\d/),overwriteMode:"replace",preprocessors:[le(),ue({dateModeTemplate:s,dateSegmentsSeparator:n})],postprocessors:[oe({min:r,max:t,dateModeTemplate:s,dateSegmentSeparator:n})]})}new RegExp(`[${z.map(v).join("")}]$`);function G({decimalSeparator:e,isNegativeAllowed:n,precision:t,thousandSeparator:r,prefix:s,postfix:o,decimalPseudoSeparators:i=[],pseudoMinuses:c=[]}){const u=y(s),l="\\d",a=n?`[${N}${c.map(p=>`\\${p}`).join("")}]?`:"",g=r?`[${l}${v(r)}]*`:`[${l}]*`,d=t>0?`([${v(e)}${i.map(v).join("")}]${l}{0,${Number.isFinite(t)?t:""}})?`:"",f=y(o);return new RegExp(`^${u}${a}${g}${d}${f}$`)}function y(e){return e?`${e.split("").map(n=>`${v(n)}?`).join("")}`:""}function ge(e,n){return e===","||e==="."?[".",",","б","ю"].filter(t=>t!==n&&t!==e):[]}function M(e,n="."){const t=!!e.match(new RegExp(`^\\D*[${N}\\${w}${O}${L}]`)),r=e.replace(new RegExp(`[^\\d${v(n)}]`,"g"),"").replace(n,".");return r?Number((t?w:"")+r):NaN}function fe(e){const n=String(e),[t,r]=n.split("e-");let s=n;if(r){const[,o]=t.split("."),i=Number(r)+((o==null?void 0:o.length)||0);s=e.toFixed(i)}return s}function de({decimalSeparator:e,precision:n,decimalZeroPadding:t,postfix:r}){if(n<=0||!t)return P;const s=new RegExp(`${v(r)}$`);return({value:o,selection:i})=>{if(isNaN(M(o)))return{value:o,selection:i};const[c,u=""]=o.replace(s,"").split(e);return{value:c+e+u.padEnd(n,"0")+r,selection:i}}}function ve({decimalSeparator:e,decimalPseudoSeparators:n,pseudoMinuses:t}){let r=!0;const s=G({decimalSeparator:e,decimalPseudoSeparators:n,pseudoMinuses:t,prefix:"",postfix:"",thousandSeparator:"",precision:1/0,isNegativeAllowed:!0});return({elementState:o,data:i})=>r?(r=!1,{elementState:F(o,{mask:s}),data:i}):{elementState:o,data:i}}function he(e,n){const t=s=>{const o=v(n);return s.replace(new RegExp(`^(\\D+)?[0${o}]+(?=0)`),"$1").replace(new RegExp(`^(\\D+)?[0${o}]+(?=[1-9])`),"$1")},r=(s,o)=>{const i=s.slice(0,o),c=s.slice(o).startsWith("0");return i.length-t(i).length+(c?1:0)};return({value:s,selection:o})=>{const[i,c]=o,u=s.includes(e),[l,a=""]=s.split(e),g=t(l);if(l===g)return{value:s,selection:o};const d=i-r(s,i),f=c-r(s,c);return{value:g+(u?e:"")+a,selection:[Math.max(d,0),Math.max(f,0)]}}}function pe({min:e,max:n,decimalSeparator:t}){return({value:r,selection:s})=>{const o=M(r,t),i=o>0?Math.min(o,n):Math.max(o,e);if(!Number.isNaN(o)&&i!==o){const c=`${i}`.replace(".",t).replace(w,N);return{value:c,selection:[c.length,c.length]}}return{value:r,selection:s}}}function Ee({decimalSeparator:e,thousandSeparator:n,decimalZeroPadding:t}){return({elementState:r,data:s},o)=>{const{value:i,selection:c}=r,[u,l]=c,a=i.slice(u,l),g=t?[e,n]:[n],d=t&&u>i.indexOf(e)&&!!a.match(/^0+$/gi);return o!=="deleteBackward"&&o!=="deleteForward"||!g.includes(a)&&!d?{elementState:r,data:s}:{elementState:{value:i,selection:o==="deleteForward"?[l,l]:[u,u]},data:s}}}function me({decimalSeparator:e,precision:n}){const t=new RegExp(`^\\D*${v(e)}`);return({elementState:r,data:s})=>{const{value:o,selection:i}=r,[c]=i;if(n<=0||o.includes(e)||!s.match(t))return{elementState:r,data:s};const u=o.slice(0,c).match(/\d+/);return{elementState:r,data:u?s:`0${s}`}}}function C(e,n){const t=new RegExp(`[${n.join("")}]`,"gi");return({elementState:r,data:s})=>{const{value:o,selection:i}=r;return{elementState:{selection:i,value:o.replace(t,e)},data:s.replace(t,e)}}}function De(e){return({elementState:n,data:t})=>{const{value:r,selection:s}=n,[o,i]=s;return{elementState:n,data:!r.includes(e)||r.slice(o,i+1).includes(e)?t:t.replace(new RegExp(v(e),"gi"),"")}}}function $e({thousandSeparator:e,decimalSeparator:n,prefix:t,postfix:r}){if(!e)return P;const s=new RegExp(`^${v(t)}${N}?`),o=new RegExp(`${v(r)}$`);return({value:i,selection:c})=>{const[u,l=""]=i.split(n),[a,g]=c;let[d,f]=c;const p=u.replace(s,"").replace(o,""),[m=""]=u.match(s)||[],[h=""]=u.match(o)||[],D=Array.from(p).reduceRight((E,$,R)=>{const _=!(!R&&$===e)&&E.length&&(E.length+1)%4===0;return $===e&&_?$+E:$===e&&!_?(R&&R<=a&&d--,R&&R<=g&&f--,E):_?(R<=a&&d++,R<=g&&f++,$+e+E):$+E},"");return{value:m+D+h+(i.includes(n)?n:"")+l,selection:[d,f]}}}function Re(e,n){if(e>0)return P;const t=new RegExp(`${v(n)}.*$`,"g");return({elementState:r,data:s})=>{const{value:o,selection:i}=r,[c,u]=i,l=o.replace(t,"");return{elementState:{selection:[Math.min(c,l.length),Math.min(u,l.length)],value:l},data:s.replace(t,"")}}}const S=[0,0];function Ne(e,n){const t=he(e,n);return I("blur",r=>{const s=t({value:r.value,selection:S},{value:"",selection:S}).value;r.value!==s&&(r.value=s,r.dispatchEvent(new Event("input")))},{capture:!0})}function we({min:e,max:n,decimalSeparator:t}){return I("blur",(r,s)=>{const o=M(r.value,t),i=b(o,e,n);!Number.isNaN(o)&&o!==i&&(r.value=F(fe(i),s),r.dispatchEvent(new Event("input")))},{capture:!0})}function Pe(e){return I("blur",n=>{const t=n.value.replace(new RegExp(`^(\\D+)?${v(e)}`),`$10${e}`);t!==n.value&&(n.value=t,n.dispatchEvent(new Event("input")))},{capture:!0})}function Oe({max:e=Number.MAX_SAFE_INTEGER,min:n=Number.MIN_SAFE_INTEGER,precision:t=0,thousandSeparator:r=T,decimalSeparator:s=".",decimalPseudoSeparators:o=ge(s,r),decimalZeroPadding:i=!1,prefix:c="",postfix:u=""}={}){const l=[w,O,L].filter(a=>a!==r&&a!==s);return Object.assign(Object.assign({},j),{mask:G({decimalSeparator:s,precision:t,thousandSeparator:r,prefix:c,postfix:u,isNegativeAllowed:n<0}),preprocessors:[ve({decimalSeparator:s,decimalPseudoSeparators:o,pseudoMinuses:l}),C(N,l),C(s,o),me({decimalSeparator:s,precision:t}),Ee({decimalSeparator:s,decimalZeroPadding:i,thousandSeparator:r}),Re(t,s),De(s)],postprocessors:[pe({decimalSeparator:s,min:n,max:e}),ce(c),ie(u),$e({decimalSeparator:s,thousandSeparator:r,prefix:c,postfix:u}),de({decimalSeparator:s,decimalZeroPadding:i,precision:t,postfix:u})],plugins:[Ne(s,r),Pe(s),we({min:n,max:e,decimalSeparator:s})],overwriteMode:i?({value:a,selection:[g]})=>g<=a.indexOf(s)?"shift":"replace":"shift"})}export{_e as a,M as b,Ae as c,Oe as m};
