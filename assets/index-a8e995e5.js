import{aQ as Z,aR as j,d as V,r as D,o as t,c as n,a7 as q,a as f,n as _,aS as I,s as R,_ as x,a3 as O,y as P,u as Q,Z as w,e as G,f as H,b as E,w as J,g as M,F as m,t as A,l as T,k as g,j as B,h as W,i as X,A as Y,q as ee,S as se,ai as te}from"./index-ed930d81.js";function ae(s){return!!s&&!!s.ownerDocument&&Z(s.ownerDocument)===s}function oe(s,r,l){for(s+=l;s>=0&&s<r.length;){if(j(r[s]),ae(r[s]))return;s+=l}}const ne=V({name:"DataList",__name:"DataList",setup(s){const r=D(null),l=()=>{const a=r.value,o=(a==null?void 0:a.querySelectorAll('[data-ark-data-list-item=""]'))||[];return Array.from(o)},v=(a,o)=>{const c=a.target,h=l();oe(h.indexOf(c),h,o)};return(a,o)=>(t(),n("div",{ref_key:"root",ref:r,class:_(a.$style.list),onKeydown:[o[0]||(o[0]=I(R(c=>v(c,-1),["prevent"]),["up"])),o[1]||(o[1]=I(R(c=>v(c,1),["prevent"]),["down"]))]},[q(a.$slots,"default",{},()=>[f("p",{class:_(a.$style.empty)},"Ничего не найдено",2)])],34))}}),le="_list_1iosd_1",re="_empty_1iosd_9",ce={list:le,empty:re},ie={$style:ce},we=x(ne,[["__cssModules",ie]]),ue={class:"ark-text_body-s-2"},pe=f("span",{class:"ark-text_64 ark-text_body-xs"}," • ",-1),de={key:1},ye=f("p",null,"Информация о столах будет в течение минуты",-1),me=V({__name:"TablesPreview",props:{resId:{},ids:{},showCapacity:{type:Boolean,default:!0},showZone:{type:Boolean,default:!0}},emits:["updateDto"],setup(s,{emit:r}){const l=s,v=r,{ids:a,resId:o}=O(l),c=P(te),h=Q(),L=D(w.currentLocal()),N=D(Date.now()),k=D(!1);let $=null;G(()=>{$=setInterval(()=>{N.value=Date.now()},500)}),H(()=>{$&&clearInterval($)});const z=E(()=>{const e=a.value,u=c.value;return e?(Array.isArray(e)?e:[e]).map(d=>{var F;const i=(Array.isArray(d)?d:[d]).map(y=>u[y]).filter(Boolean),K=i.map(y=>y.number),U=i.map(y=>y.capacity);return{numbers:K,capacity:U,zone:(F=i[0])==null?void 0:F.zone}}):[]}),C=E(()=>{if(z.value.length>0||!l.resId||l.resId<0)return 1/0;N.value;const e=L.value,u=w.currentLocal();return w.fromAbsoluteMilliseconds(e.shift({seconds:30}).toAbsoluteMilliseconds()-u.toAbsoluteMilliseconds()).seconds}),S=()=>{k.value=!0,h.loadReservationItem.execute({id:l.resId}).then(e=>{e&&v("updateDto",e)}).catch(()=>null).finally(()=>{L.value=w.currentLocal(),k.value=!1})};return J([k,C],([e,u])=>{!e&&u<0&&S()},{immediate:!0}),(e,u)=>z.value.length>0?(t(!0),n(m,{key:0},M(z.value,(p,d)=>(t(),n("div",{key:d},[f("p",ue,[(t(!0),n(m,null,M(p.numbers,(b,i)=>(t(),n("span",{key:i,class:_(e.$style.number)},A(b),3))),128)),e.showCapacity?(t(),n(m,{key:0},[pe,(t(!0),n(m,null,M(p.capacity,(b,i)=>(t(),n("span",{key:i,class:_(e.$style.capacity)},A(b),3))),128))],64)):T("",!0)]),e.showZone?(t(),n("p",{key:0,class:_(["ark-text_64 ark-text_body-xs",e.$style.zone])},A(p.zone),3)):T("",!0)]))),128)):g(o)&&g(o)>0?(t(),n("div",de,[ye,f("p",null,[B(" Автообновление "),k.value?(t(),ee(g(se),{key:1,name:"spinner",size:12})):(t(),n(m,{key:0},[B("через "+A(C.value)+" сек ",1),W(g(Y),{appearance:"flat",size:"xs",icon:"refresh",class:"ark-space_left-1","icon-size":12,onClick:S},{default:X(()=>[B("Обновить")]),_:1})],64))])])):T("",!0)}}),_e="_number_1hp70_2",fe="_capacity_1hp70_14",ve="_zone_1hp70_26",he={number:_e,capacity:fe,zone:ve},ke={$style:he},Ae=x(me,[["__cssModules",ke]]);export{we as D,Ae as T};
