import{ap as M}from"./index-6367d8ff.js";const Z={modelModifiers:()=>({}),expandable:!0,rows:10},E=new Map;function T(e,{value:t}){let r=null;function u(o){r===null&&(o.stopPropagation(),o.preventDefault(),r=o,t.onPanning(!0))}function i(o){if(!r||r.pointerId!==o.pointerId)return;o.stopPropagation(),o.preventDefault();const m=o.clientX-r.clientX,d=o.clientY-r.clientY;t.onEvent([m,d]),r=o}function p(o){o.pointerId===(r==null?void 0:r.pointerId)&&(o.stopPropagation(),o.preventDefault(),r=null,t.onPanning(!1))}e.addEventListener("pointerdown",u),document.addEventListener("pointermove",i),document.addEventListener("pointerup",p),E.set(e,[u,i,p])}function $(e){const t=E.get(e);t&&(e.removeEventListener("pointerdown",t[0]),document.removeEventListener("pointermove",t[1]),document.removeEventListener("pointerup",t[2]),E.delete(e))}const j={mounted:T,beforeUnmount:$},L=new Map;function Y(e,t){return Math.sqrt(Math.pow(e.cx-t.cx,2)+Math.pow(e.cy-t.cy,2))}function X(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function k(e,{value:t}){let r=0,u=t.matrix.value.scale,i=[],p={x:0,y:0};function o(n){if(d(n),i.push({id:n.pointerId,x:n.offsetX,y:n.offsetY,cx:n.clientX,cy:n.clientY}),i.length>1){const c=i[0],s=i[1];r=Y(c,s),u=t.matrix.value.scale,p=X(c,s)}}function m(n){if(i.length<2)return;n.preventDefault(),n.stopPropagation(),i=i.map(I=>I.id===n.pointerId?{id:n.pointerId,x:n.offsetX,y:n.offsetY,cx:n.clientX,cy:n.clientY}:I);const c=i[0],s=i[1],v=Y(c,s),l=u*v/r,a=M(l,.6,5),x=t.matrix.value.translate,y=x.x,b=x.y,f=X(c,s),g=.1+(a-.6)*(2-.6)/(5-.6),D=(f.x-p.x)*g,P=(f.y-p.y)*g,_=t.matrix.value.scale,S=y+D,U=b+P,q=a/_*(S-f.x)+f.x,C=a/_*(U-f.y)+f.y;t.onEvent(a,q,C)}function d(n){i=i.filter(({id:c})=>c!==n.pointerId),t.onRelease()}function h(n){if(n.shiftKey)return;n.stopPropagation(),n.preventDefault();const c=Math.max(-1,Math.min(1,n.wheelDelta||-n.detail));let s=Math.abs(n.deltaY)/50;s=c<0?-s:s;const v=t.matrix.value.scale,l=M(v+s,.4,5),a=t.matrix.value.translate,x=l/v*(a.x-n.offsetX)+n.offsetX,y=l/v*(a.y-n.offsetY)+n.offsetY;t.onEvent(l,x,y)}function w(n){n.cancelable&&(n.preventDefault(),n.stopPropagation())}e.addEventListener("pointerdown",o),e.addEventListener("pointermove",m),document.addEventListener("pointerup",d),e.addEventListener("pointercancel",d),e.addEventListener("touchmove",w),e.addEventListener("wheel",h),L.set(e,[o,m,d,w,h])}function K(e){const t=L.get(e);t&&(e.removeEventListener("pointerdown",t[0]),e.removeEventListener("pointermove",t[1]),document.removeEventListener("pointerup",t[2]),e.removeEventListener("pointercancel",t[2]),e.removeEventListener("touchmove",t[3]),e.removeEventListener("wheel",t[4]),L.delete(e))}const z={mounted:k,beforeUnmount:K};export{Z as I,z as a,j as v};
