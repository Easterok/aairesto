import{d as ge,l as Se,r as u,ab as de,aa as Z,a9 as R,af as $e,an as we,b,am as ve,w as pe,c as $,a as t,F as ee,n,k as W,t as w,h as a,s as r,i as e,q as oe,j as y,at as Ae,y as Xe,$ as ze,ad as Be,o as d,g as Le,x as se,a0 as Ue,S as X,av as et,v as Me,B as De,D as tt,aw as je,_ as ye,ap as be,b4 as at,M as st,C as ut,Q as nt,ah as ct,b5 as _t,G as dt,b6 as mt,u as lt,a1 as He,aL as Fe,aK as Pe,aG as Je,e as pt,a3 as ft,a4 as vt,aW as gt}from"./index-f01f95e2.js";import{i as yt}from"./index-a0fdf255.js";import{c as Ie,D as Te,u as qe,a as Oe,i as kt,_ as ht,B as bt,Q as $t}from"./index-6eb5dfb3.js";import{_ as ae}from"./index-644bde6f.js";import{D as Ee}from"./index-5edd6516.js";import{E as Ke}from"./index-1eae7b5e.js";import{_ as ot}from"./index-b1bee2fe.js";import{F as wt}from"./index-953ce25b.js";import{c as Ve,r as fe,s as Re}from"./index-e0d70f45.js";import{P as St}from"./index-9b5bd4ab.js";import"./index-edaad5b3.js";import"./index-78d06d09.js";/* empty css              */const Vt=["байт","Кб","Мб","Гб","Тб","Пб","Эб","Зб","Иб"],We=1024,Ct=(G,j=0)=>{if(G===0)return"0 байт";const F=j<0?0:j,H=Math.floor(Math.log(G)/Math.log(We));return parseFloat((G/Math.pow(We,H)).toFixed(F))+" "+Vt[H]},Lt=["data-fixed"],Mt=["src","alt"],zt=t("h6",{class:"ark-text_h6 ark-space_bottom-3"},"Подтверждение",-1),Nt=t("p",{class:"ark-space_bottom-1"}," На это время уже нет свободных столов ",-1),Dt={class:"ark-space_bottom-4"},It=t("div",null,[t("p",null,"Не удалось забронировать"),t("p",{class:"ark-text_body-s"},"Попробуй еще раз")],-1),Tt=ge({__name:"Fill",props:{restId:{},showLang:{type:Boolean,default:!0},showTelegram:{type:Boolean,default:!0},fullfillPhone:{default:""},fixed:{type:Boolean,default:!0}},setup(G){const j=G,F=[{id:"ru",name:"Русский"},{id:"en",name:"English"},{id:"zh",name:"中国人"}],H=Xe(),c=Oe(),m=Se(),{locale:x,t:L}=qe();u(!1);const q=u(!1),J=u(de.currentLocal()),S=u(new Z(de.currentLocal(),new R(0,0))),P=u(de.currentLocal()),Q=u(null),B=u(null),N=u(!1);u(!1);const o=u(new Z(de.currentLocal(),new R(18,0))),p=u(!1),V=u(!1),ie=u(null);u(NaN);const te=localStorage.getItem("__airestro_phone"),Y=localStorage.getItem("__airestro_name");typeof te=="string"&&$e(te).length===11&&we(te);const v=typeof Y=="string"?Y:null,C=Ve({phone:["+7",{required:fe,phone:Re(!0)}],name:[v],comment:[""]});ze(je,{required:"validators.phone",phone:"validators.required"});const g=u(null),l=u(2),O=u(""),U=u(null),ne=[{toRest:"День рождения",name:"special.birthday",icon:"cake"},{toRest:"Свидание",name:"special.date",icon:"heart"},{toRest:"Деловая встреча",name:"special.business",icon:"business"},{toRest:"Хочу напиться",name:"special.drink",icon:"wine"},{toRest:"Хочу поесть",name:"special.food",icon:"food"}],me=i=>{const{date:k,time:T,count:h}=i;let A=null,K=null,ce=null;try{A=typeof k=="string"?de.jsonParse(k):null,K=typeof T=="string"?R.fromString(T):null,ce=typeof h=="string"&&!Number.isNaN(h)?Number(h):null}catch{}return A&&K&&ce!==null?{day:A,time:K,count:ce,datetime:new Z(A,K)}:null},_=b(()=>H.currentRoute.value.query);b(()=>me(_.value));const D=b(()=>{const i=x.value;return F.find(k=>k.id===i).name}),I=b(()=>p.value?null:g.value),s=b(()=>{const i=I.value;let k=i==null?void 0:i.opening_time,T=i==null?void 0:i.closing_time;return!k||!T?"":(k=R.fromString(k).toString("HH:MM"),T=R.fromString(T).toString("HH:MM"),`${k} - ${T}`)});b(()=>{const i=P.value,k=I.value,T=k==null?void 0:k.opening_time,h=k==null?void 0:k.closing_time;if(!T||!h)return[];const A=S.value.valueOf(),K=R.fromString(T),ce=R.fromString(h).shift({ms:1});let _e=i;return K.toAbsoluteMilliseconds()>ce.toAbsoluteMilliseconds()&&(_e=_e.append({day:1})),Ie(new Z(i,K),new Z(_e,ce),{minutes:15}).filter(he=>he.valueOf()>=A)}),b(()=>{const i=J.value;return new Array(10).fill("").map((k,T)=>i.append({day:T}))});const f=Be*30,M=b(()=>{const i=B.value??[];if(i.length===0)return{bestMatch:[],acc:[]};const k=i.reduce((ce,_e)=>(_e.zone==="default"&&ce.push(..._e.slots),ce),[]),T=Q.value,h=[];let A=[],K=-1;return k.forEach(ce=>{const _e=new Date(ce.start_time),he=_e.getMinutes()%15;he!==0&&_e.setMinutes(_e.getMinutes()+(15-he));const it=Z.jsonParse(_e.toJSON()),xe=Z.fromString(ce.end_time,"YMD"," "),rt=xe.time.shift({ms:1}),Qe=Ie(it,new Z(xe.day,rt),{minutes:15});h.push(...Qe),T!==null&&Qe.forEach(Ze=>{const Ge=Math.abs(Ze.valueOf()-T.valueOf());Ge<=f&&(Ge===0&&(K=A.length),A.push(Ze))})}),K!==-1&&(A=A.slice(K,K+2)),{acc:h,bestMatch:A}}),z=["человека","человек","человек"];b(()=>{const i=l.value;return ve(z,i)});const E=["человек","человека","человек"],le=b(()=>{const i=l.value;return ve(E,i)});b(()=>{const i=o.value.toJSON(),k=M.value.acc;return N.value||!!k.find(T=>T.toJSON()===i)}),b(()=>{const i=ie.value;if(!i)return{desc:"",icon:"",daytime:null,status:void 0,count:0,name:""};let k="booking.success.description.confirmed";const T="check";let h="success";switch(i.status){case Te.CANCELLED:case Te.CANCELLED_NO_DEPOSIT:k="booking.success.description.cancelled",h="info";break}const[A]=i.seating_time.split("+"),K=A.split("T"),ce=de.jsonParse(K[0]),_e=R.fromString(K[1]);return{desc:k,icon:T,daytime:new Z(ce,_e),status:h,name:i.name_for_reservation,count:`${i.num_people} ${ve(E,i.num_people)}`}});const re=i=>{const k=U.value;U.value=i===k?null:i},ue=({day:i,time:k})=>`${i.toJSON()} ${k.toString("HH:MM")}`,ke=()=>{if(q.value=!1,C.validate(),C.invalid.value||V.value)return;const{phone:i,name:k}=C.getCurrentValue();V.value=!0,localStorage.setItem("__airestro_phone",i),k&&localStorage.setItem("__airestro_name",k);const T=U.value,h=T?`Событие: ${T}`:"",A=O.value.trim(),K=A?`Пожеление: ${A}`:"",ce=["Самостоятельная запись",h,K].filter(Boolean).join(". "),_e=o.value;c.createBooking.execute({restaurant:Number(j.restId),num_people:l.value,name_for_reservation:k,phone_number:`+${$e(i)}`,comment:ce,seating_time:ue(_e)}).then(he=>{ie.value=he}).catch(()=>{q.value=!0}).finally(()=>{V.value=!1})};return pe(P,i=>{if(Q.value){const k=Q.value.time;Q.value=new Z(i,k)}}),pe(()=>j.restId,i=>{p.value=!0,c.loadRestaurant.execute({id:i}).then(k=>{if(g.value=k,k){const T=new Date(new Date().toLocaleString("en",{timeZone:k.timezone})),h=de.fromLocalNativeDate(T),A=R.fromLocalNativeDate(T);J.value=h,S.value=new Z(h,A),B.value=[{zone:"default",slots:[{start_time:`${h.toJSON()} 11:00`,end_time:`${h.toJSON()} 23:00`}]}]}}).catch(()=>{m.show("resto.error_text",{type:"error",label:"resto.error_title"})}).finally(()=>{p.value=!1})},{immediate:!0}),(i,k)=>{var T;return d(),$(ee,null,[t("div",{class:n(i.$style.imageContainer),"data-fixed":i.fixed},[p.value?(d(),$("div",{key:1,class:n(["ark-skeleton",i.$style.image])},null,2)):(d(),$(ee,{key:0},[g.value&&g.value.link_to_image?(d(),$("img",{key:0,src:g.value.link_to_image,class:n(i.$style.image),alt:g.value.name},null,10,Mt)):W("",!0)],64)),t("div",{class:n(i.$style.imageContainer__content)},[t("h1",{class:n(["ark-text_h5 ark-space_bottom-2",p.value&&"ark-skeleton"])},w(p.value?"Stub stub stub":(T=g.value)==null?void 0:T.name),3),t("p",{class:n(["ark-text_body-s",p.value&&"ark-skeleton"])},w(i.$t("working"))+" "+w(p.value?"Stub stub":s.value),3)],2),i.showLang?(d(),$("div",{key:2,class:n(i.$style.language)},[a(e(Ue),{"min-width":144},{dropdown:r(()=>[a(e(Ee),null,{default:r(()=>[(d(),$(ee,null,Le(F,h=>a(e(se),{key:h.id,"data-ark-data-list-item":"",size:"s",appearance:"menu-option","icon-right":h.name===D.value?"check":void 0,onClick:A=>x.value=h.id},{default:r(()=>[y(w(h.name),1)]),_:2},1032,["icon-right","onClick"])),64))]),_:1})]),default:r(()=>[a(e(se),{appearance:"white",size:"xs",icon:"lang"},{default:r(()=>[y(w(D.value),1)]),_:1})]),_:1})],2)):W("",!0)],10,Lt),t("div",{class:n(i.$style.content)},[t("div",{class:n(["ark-space_bottom-4",i.$style.stepper])},[t("p",{class:n(i.$style.stepper__item),"data-current":!1,"data-done":!0},[(d(),oe(e(X),{key:0,name:"check",class:n(i.$style.stepper__count)},null,8,["class"])),y(" Выбор времени ")],2),t("p",{class:n(i.$style.stepper__item),"data-current":!0,"data-done":!1},[ie.value?(d(),oe(e(X),{key:0,name:"check",class:n(i.$style.stepper__count)},null,8,["class"])):(d(),$("span",{key:1,class:n(i.$style.stepper__count)}," 2 ",2)),y(" Подтверждение ")],2)],2),a(Ae,{name:"ark-list-right-transition"},{default:r(()=>[t("div",{class:n(i.$style.animationBoundary)},[zt,t("div",{class:n(["ark-space_bottom-1",i.$style.inline])},[a(e(X),{name:"calendar",size:16}),a(e(et),{mask:"[weekday:short], [day:numeric] [month:long] в [hour:numeric]:[minute:numeric]",date:o.value.toJSON()},null,8,["date"])],2),t("div",{class:n(["ark-space_bottom-1",i.$style.inline])},[a(e(X),{name:"user",size:16}),y(" "+w(l.value)+" "+w(le.value),1)],2),t("div",{style:{color:"var(--ark-text-color-80)",display:"inline-flex"},class:n(["ark-space_bottom-4",i.$style.inline])},[a(e(X),{name:"arrow-left",size:16}),y(" Изменить ")],2),a(e(Ke),{opened:!0},{default:r(()=>[t("div",{class:n(["ark-space_bottom-4",i.$style.notification])},[a(e(X),{name:"warning"}),t("div",null,[Nt,a(e(se),{size:"xs"},{default:r(()=>[y(" Выбрать другое время ")]),_:1})])],2)]),_:1}),t("form",{onSubmit:Me(ke,["prevent"])},[a(e(ae),{class:"ark-space_bottom-4",control:e(C).phone},{default:r(({model:h})=>[a(e(ot),{modelValue:h.value,"onUpdate:modelValue":A=>h.value=A,required:"",size:"l","has-cleaner":!1,label:i.$t("phone")},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},8,["control"]),a(e(ae),{class:"ark-space_bottom-4",control:e(C).name},{default:r(({model:h})=>[a(e(De),{modelValue:h.value,"onUpdate:modelValue":A=>h.value=A,size:"l","has-cleaner":!1,label:i.$t("name")},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},8,["control"]),t("div",Dt,[t("p",{class:n(i.$style.label)},w(i.$t("queue.special")),3),tt((d(),$("div",{class:n(i.$style.tabs)},[(d(),$(ee,null,Le(ne,h=>a(e(se),{key:h.toRest,type:"button",size:"s",appearance:U.value===h.toRest?"primary":"neutral",icon:h.icon,"icon-size":16,onClick:A=>re(h.toRest)},{default:r(()=>[y(w(i.$t(h.name)),1)]),_:2},1032,["appearance","icon","onClick"])),64))],2)),[[e(wt)]])]),a(e(ae),{class:"ark-space_bottom-6",control:e(C).comment},{default:r(({model:h})=>[a(e(De),{modelValue:h.value,"onUpdate:modelValue":A=>h.value=A,size:"l","has-cleaner":!1,label:i.$t("request")},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},8,["control"]),a(e(Ke),{opened:!0},{default:r(()=>[t("div",{class:n(["ark-space_bottom-4",i.$style.notification])},[a(e(X),{name:"warning"}),It],2)]),_:1}),a(e(se),{type:"submit",style:{width:"100%"},size:"l",loading:V.value||N.value},{default:r(()=>[y(w(i.$t("confirm")),1)]),_:1},8,["loading"])],32)],2)]),_:1})],2)],64)}}}),At="_imageContainer_y8ce6_1",Bt="_imageContainer__content_y8ce6_17",Ut="_stepper_y8ce6_41",jt="_stepper__item_y8ce6_48",qt="_stepper__count_y8ce6_69",Ot="_image_y8ce6_1",Et="_content_y8ce6_93",Rt="_label_y8ce6_109",Ft="_animationBoundary_y8ce6_115",Pt="_buttons_y8ce6_120",Ht="_language_y8ce6_128",Jt="_notification_y8ce6_138",xt="_emptyState_y8ce6_175",Qt="_dates_y8ce6_183",Zt="_dates__item_y8ce6_197",Gt="_inputLike_y8ce6_237",Kt="_inputLike__label_y8ce6_272",Wt="_inputLike__content_y8ce6_279",Yt="_inputLike__select_y8ce6_289",Xt="_tabs_y8ce6_299",ea="_submit_y8ce6_305",ta="_marker_y8ce6_314",aa="_success_y8ce6_324",sa="_slots_y8ce6_334",na="_slots__item_y8ce6_339",la="_slots__item_flat_y8ce6_370",oa="_date_y8ce6_183",ia="_date__select_y8ce6_402",ra="_inline_y8ce6_438",ua="_inline_m_y8ce6_445",ca={imageContainer:At,imageContainer__content:Bt,stepper:Ut,stepper__item:jt,stepper__count:qt,image:Ot,content:Et,label:Rt,animationBoundary:Ft,buttons:Pt,language:Ht,notification:Jt,emptyState:xt,dates:Qt,dates__item:Zt,inputLike:Gt,inputLike__label:Kt,inputLike__content:Wt,inputLike__select:Yt,tabs:Xt,submit:ea,marker:ta,success:aa,slots:sa,slots__item:na,slots__item_flat:la,date:oa,date__select:ia,inline:ra,inline_m:ua},_a={$style:ca},da=ye(Tt,[["__cssModules",_a]]),ma=["data-fixed"],pa=["src","alt"],fa={class:"ark-text_h6 ark-space_bottom-3"},va=["data-status"];const ga=t("p",{class:"ark-text_body-l ark-text_medium ark-space_top-2"},"Ждем вас",-1),ya=ge({__name:"Success",props:{restId:{},showLang:{type:Boolean,default:!0},showTelegram:{type:Boolean,default:!0},fullfillPhone:{default:""},fixed:{type:Boolean,default:!0}},setup(G){const j=G,F=[{id:"ru",name:"Русский"},{id:"en",name:"English"},{id:"zh",name:"中国人"}],H=Xe(),c=Oe(),m=Se(),{locale:x,t:L}=qe();u(!1),u(!1);const q=u(de.currentLocal()),J=u(new Z(de.currentLocal(),new R(0,0))),S=u(de.currentLocal()),P=u(null),Q=u(null),B=u(!1);u(!1);const N=u(new Z(de.currentLocal(),new R(18,0))),o=u(!1);u(!1);const p=u(null);u(NaN);const V=localStorage.getItem("__airestro_phone"),ie=localStorage.getItem("__airestro_name");typeof V=="string"&&$e(V).length===11&&we(V);const te=typeof ie=="string"?ie:null;Ve({phone:["+7",{required:fe,phone:Re(!0)}],name:[te],comment:[""]}),ze(je,{required:"validators.phone",phone:"validators.required"});const Y=u(null),v=u(2);u(""),u(null);const C=s=>{const{date:f,time:M,count:z}=s;let E=null,le=null,re=null;try{E=typeof f=="string"?de.jsonParse(f):null,le=typeof M=="string"?R.fromString(M):null,re=typeof z=="string"&&!Number.isNaN(z)?Number(z):null}catch{}return E&&le&&re!==null?{day:E,time:le,count:re,datetime:new Z(E,le)}:null},g=b(()=>H.currentRoute.value.query);b(()=>C(g.value));const l=b(()=>{const s=x.value;return F.find(f=>f.id===s).name}),O=b(()=>o.value?null:Y.value),U=b(()=>{const s=O.value;let f=s==null?void 0:s.opening_time,M=s==null?void 0:s.closing_time;return!f||!M?"":(f=R.fromString(f).toString("HH:MM"),M=R.fromString(M).toString("HH:MM"),`${f} - ${M}`)});b(()=>{const s=S.value,f=O.value,M=f==null?void 0:f.opening_time,z=f==null?void 0:f.closing_time;if(!M||!z)return[];const E=J.value.valueOf(),le=R.fromString(M),re=R.fromString(z).shift({ms:1});let ue=s;return le.toAbsoluteMilliseconds()>re.toAbsoluteMilliseconds()&&(ue=ue.append({day:1})),Ie(new Z(s,le),new Z(ue,re),{minutes:15}).filter(ke=>ke.valueOf()>=E)}),b(()=>{const s=q.value;return new Array(10).fill("").map((f,M)=>s.append({day:M}))});const ne=Be*30,me=b(()=>{const s=Q.value??[];if(s.length===0)return{bestMatch:[],acc:[]};const f=s.reduce((re,ue)=>(ue.zone==="default"&&re.push(...ue.slots),re),[]),M=P.value,z=[];let E=[],le=-1;return f.forEach(re=>{const ue=new Date(re.start_time),ke=ue.getMinutes()%15;ke!==0&&ue.setMinutes(ue.getMinutes()+(15-ke));const i=Z.jsonParse(ue.toJSON()),k=Z.fromString(re.end_time,"YMD"," "),T=k.time.shift({ms:1}),h=Ie(i,new Z(k.day,T),{minutes:15});z.push(...h),M!==null&&h.forEach(A=>{const K=Math.abs(A.valueOf()-M.valueOf());K<=ne&&(K===0&&(le=E.length),E.push(A))})}),le!==-1&&(E=E.slice(le,le+2)),{acc:z,bestMatch:E}}),_=["человека","человек","человек"];b(()=>{const s=v.value;return ve(_,s)});const D=["человек","человека","человек"];b(()=>{const s=v.value;return ve(D,s)}),b(()=>{const s=N.value.toJSON(),f=me.value.acc;return B.value||!!f.find(M=>M.toJSON()===s)});const I=b(()=>{const s=p.value;if(!s)return{desc:"booking.success.description.confirmed",icon:"check",daytime:new Z(de.fromLocalNativeDate(new Date),R.fromLocalNativeDate(new Date)),status:"success",count:`2 ${ve(D,2)}`,name:"Константин"};let f="booking.success.description.confirmed";const M="check";let z="success";switch(s.status){case Te.CANCELLED:case Te.CANCELLED_NO_DEPOSIT:f="booking.success.description.cancelled",z="info";break}const[E]=s.seating_time.split("+"),le=E.split("T"),re=de.jsonParse(le[0]),ue=R.fromString(le[1]);return{desc:f,icon:M,daytime:new Z(re,ue),status:z,name:s.name_for_reservation,count:`${s.num_people} ${ve(D,s.num_people)}`}});return pe(S,s=>{if(P.value){const f=P.value.time;P.value=new Z(s,f)}}),pe(()=>j.restId,s=>{o.value=!0,c.loadRestaurant.execute({id:s}).then(f=>{if(Y.value=f,f){const M=new Date(new Date().toLocaleString("en",{timeZone:f.timezone})),z=de.fromLocalNativeDate(M),E=R.fromLocalNativeDate(M);q.value=z,J.value=new Z(z,E),Q.value=[{zone:"default",slots:[{start_time:`${z.toJSON()} 11:00`,end_time:`${z.toJSON()} 23:00`}]}]}}).catch(()=>{m.show("resto.error_text",{type:"error",label:"resto.error_title"})}).finally(()=>{o.value=!1})},{immediate:!0}),(s,f)=>{var M;return d(),$(ee,null,[t("div",{class:n(s.$style.imageContainer),"data-fixed":s.fixed},[o.value?(d(),$("div",{key:1,class:n(["ark-skeleton",s.$style.image])},null,2)):(d(),$(ee,{key:0},[Y.value&&Y.value.link_to_image?(d(),$("img",{key:0,src:Y.value.link_to_image,class:n(s.$style.image),alt:Y.value.name},null,10,pa)):W("",!0)],64)),t("div",{class:n(s.$style.imageContainer__content)},[t("h1",{class:n(["ark-text_h5 ark-space_bottom-2",o.value&&"ark-skeleton"])},w(o.value?"Stub stub stub":(M=Y.value)==null?void 0:M.name),3),t("p",{class:n(["ark-text_body-s",o.value&&"ark-skeleton"])},w(s.$t("working"))+" "+w(o.value?"Stub stub":U.value),3)],2),s.showLang?(d(),$("div",{key:2,class:n(s.$style.language)},[a(e(Ue),{"min-width":144},{dropdown:r(()=>[a(e(Ee),null,{default:r(()=>[(d(),$(ee,null,Le(F,z=>a(e(se),{key:z.id,"data-ark-data-list-item":"",size:"s",appearance:"menu-option","icon-right":z.name===l.value?"check":void 0,onClick:E=>x.value=z.id},{default:r(()=>[y(w(z.name),1)]),_:2},1032,["icon-right","onClick"])),64))]),_:1})]),default:r(()=>[a(e(se),{appearance:"white",size:"xs",icon:"lang"},{default:r(()=>[y(w(l.value),1)]),_:1})]),_:1})],2)):W("",!0)],10,ma),t("div",{class:n(s.$style.content)},[t("div",{class:n(["ark-space_bottom-4",s.$style.stepper])},[t("p",{class:n(s.$style.stepper__item),"data-current":!1,"data-done":!0},[(d(),oe(e(X),{key:0,name:"check",class:n(s.$style.stepper__count)},null,8,["class"])),y(" Выбор времени ")],2),t("p",{class:n(s.$style.stepper__item),"data-current":!0,"data-done":!0},[(d(),oe(e(X),{key:0,name:"check",class:n(s.$style.stepper__count)},null,8,["class"])),y(" Подтверждение ")],2)],2),a(Ae,{name:"ark-list-right-transition"},{default:r(()=>{var z;return[t("div",{class:n(s.$style.animationBoundary)},[t("h6",fa,w(s.$t("booking.success.title")),1),t("div",{class:n(s.$style.notification),"data-status":I.value.status},[I.value.icon?(d(),oe(e(X),{key:0,size:20,name:I.value.icon},null,8,["name"])):W("",!0),t("div",null,[t("p",null,w(s.$t(I.value.desc,I.value)),1)])],10,va),W("",!0),ga,I.value.daytime?(d(),$("div",{key:1,class:n(["ark-space_bottom-1",[s.$style.inline,s.$style.inline_m]])},[a(e(X),{name:"calendar",size:20}),a(e(et),{mask:"[weekday:long], [day:numeric] [month:long] в [hour:numeric]:[minute:numeric]",date:I.value.daytime.toJSON()},null,8,["date"])],2)):W("",!0),t("div",{class:n(["ark-space_bottom-1",[s.$style.inline,s.$style.inline_m]])},[a(e(X),{name:"user",size:20}),y(" "+w(I.value.name)+", "+w(I.value.count),1)],2),t("div",{class:n(["ark-space_bottom-1",[s.$style.inline,s.$style.inline_m]])},[a(e(X),{name:"pin",size:20}),y(" "+w((z=Y.value)==null?void 0:z.address),1)],2)],2)]}),_:1})],2)],64)}}}),ka="_imageContainer_y8ce6_1",ha="_imageContainer__content_y8ce6_17",ba="_stepper_y8ce6_41",$a="_stepper__item_y8ce6_48",wa="_stepper__count_y8ce6_69",Sa="_image_y8ce6_1",Va="_content_y8ce6_93",Ca="_label_y8ce6_109",La="_animationBoundary_y8ce6_115",Ma="_buttons_y8ce6_120",za="_language_y8ce6_128",Na="_notification_y8ce6_138",Da="_emptyState_y8ce6_175",Ia="_dates_y8ce6_183",Ta="_dates__item_y8ce6_197",Aa="_inputLike_y8ce6_237",Ba="_inputLike__label_y8ce6_272",Ua="_inputLike__content_y8ce6_279",ja="_inputLike__select_y8ce6_289",qa="_tabs_y8ce6_299",Oa="_submit_y8ce6_305",Ea="_marker_y8ce6_314",Ra="_success_y8ce6_324",Fa="_slots_y8ce6_334",Pa="_slots__item_y8ce6_339",Ha="_slots__item_flat_y8ce6_370",Ja="_date_y8ce6_183",xa="_date__select_y8ce6_402",Qa="_inline_y8ce6_438",Za="_inline_m_y8ce6_445",Ga={imageContainer:ka,imageContainer__content:ha,stepper:ba,stepper__item:$a,stepper__count:wa,image:Sa,content:Va,label:Ca,animationBoundary:La,buttons:Ma,language:za,notification:Na,emptyState:Da,dates:Ia,dates__item:Ta,inputLike:Aa,inputLike__label:Ba,inputLike__content:Ua,inputLike__select:ja,tabs:qa,submit:Oa,marker:Ea,success:Ra,slots:Fa,slots__item:Pa,slots__item_flat:Ha,date:Ja,date__select:xa,inline:Qa,inline_m:Za},Ka={$style:Ga},Wa=ye(ya,[["__cssModules",Ka]]),Ya=["data-fixed"],Xa=["src","alt"],es=["data-done"],ts={class:"ark-text_h6 ark-space_bottom-1"},as=ge({__name:"Second",props:{restId:{},showLang:{type:Boolean,default:!0},fullfillPhone:{default:""},fixed:{type:Boolean,default:!0}},setup(G){const j=G,F=[{id:"ru",name:"Русский"},{id:"en",name:"English"},{id:"zh",name:"中国人"}],H=Oe(),c=Se(),m=qe(),x=m.locale;u(!1);const L=u(0),q=u(!1),J=u(!1),S=localStorage.getItem("__airestro_phone"),P=localStorage.getItem("__airestro_name"),Q=typeof S=="string"&&$e(S).length===11?we(S):"+7",B=typeof P=="string"?P:null,N=Ve({phone:["+7",{required:fe,phone:Re(!0)}],name:[B]});ze(je,{required:"validators.phone",phone:"validators.required"});const o=u(null),p=u(2),V=u(""),ie=u([]),te=u(null),Y=u(null),v=["минута","минуты","минут"],C=b(()=>{const _=x.value;return F.find(D=>D.id===_).name}),g=b(()=>{const _=be(p.value,2,8),I=ie.value.find(z=>z.num_people>=_);if(!I)return"...";const s=be(I.time_difference_minutes,0,1/0),f=R.fromAbsoluteMilliseconds(s*Be),M=ve(v,f.minutes);return f.hours?m.t("1_hour"):`${f.minutes} ${M}`});function l(_){if(!_)return"";const[D,I]=_.split("+"),s=new Date(D).valueOf(),f=new Date(new Date().toLocaleString("en",{timeZone:`+${I}`})).valueOf(),{hours:M,minutes:z}=R.fromAbsoluteMilliseconds(be(s-f,0,at-1));return M!==0?m.t("1_hour"):m.t("queue_minutes",{minutes:z})}b(()=>{const _=te.value;if(_){const D=g.value;return{time:l(_.seating_time)||D}}return{time:""}});const O=b(()=>q.value?null:o.value),U=b(()=>{const _=O.value;let D=_==null?void 0:_.opening_time,I=_==null?void 0:_.closing_time;return!D||!I?"":(D=R.fromString(D).toString("HH:MM"),I=R.fromString(I).toString("HH:MM"),`${D} - ${I}`)}),ne=()=>{if(N.validate(),N.invalid.value)return;const{phone:_,name:D}=N.getCurrentValue();J.value=!0,localStorage.setItem("__airestro_phone",_),D&&localStorage.setItem("__airestro_name",D);const I=Y.value,s=I?`Событие: ${I}`:"",f=V.value.trim(),M=f?`Пожеление: ${f}`:"",z=["Самостоятельная запись",s,M].filter(Boolean).join(". ");H.joinQueue.execute({restaurant:Number(j.restId),status:"Живая очередь",num_people:p.value,name_for_reservation:D,phone_number:`+${$e(_)}`,foreigner:!1,comment:z}).then(E=>{te.value=E}).catch(E=>{Array.isArray(E)&&E[0]&&E[0].error&&E[0].error==="A reservation with this phone number already exists in the queue."?c.show("queue_notifiy",{type:"info",label:"queue_already"}):c.show("queue_error_desc",{type:"error",label:"queue_error"})}).finally(()=>{J.value=!1})};pe(()=>j.restId,_=>{q.value=!0,H.loadRestaurant.execute({id:_}).then(D=>{o.value=D}).catch(()=>{c.show("resto.error_text",{type:"error",label:"resto.error_title"})}).finally(()=>{q.value=!1})},{immediate:!0});let me=null;return pe(te,(_,D,I)=>{I(()=>{me&&clearTimeout(me)}),_&&(me=setTimeout(()=>{H.queueInfo.execute({id:_.id}).then(s=>{s&&(te.value=s)})},30*st))}),pe(()=>j.restId,_=>{document.documentElement.setAttribute("data-rest",_)},{immediate:!0}),pe(()=>j.fullfillPhone,_=>{N.phone.setValue(_?we(_):Q)},{immediate:!0}),(_,D)=>{var I;return d(),$(ee,null,[t("div",{class:n(_.$style.imageContainer),"data-fixed":_.fixed},[q.value?(d(),$("div",{key:1,class:n(["ark-skeleton",_.$style.image])},null,2)):(d(),$(ee,{key:0},[o.value&&o.value.link_to_image?(d(),$("img",{key:0,src:o.value.link_to_image,class:n(_.$style.image),alt:o.value.name},null,10,Xa)):W("",!0)],64)),t("div",{class:n(_.$style.imageContainer__content)},[t("h1",{class:n(["ark-text_h5 ark-space_bottom-2",q.value&&"ark-skeleton"])},w(q.value?"Stub stub stub":(I=o.value)==null?void 0:I.name),3),t("p",{class:n(["ark-text_body-s",q.value&&"ark-skeleton"])},w(_.$t("working"))+" "+w(q.value?"Stub stub":U.value),3)],2),_.showLang?(d(),$("div",{key:2,class:n(_.$style.language)},[a(e(Ue),{"min-width":144},{dropdown:r(()=>[a(e(Ee),null,{default:r(()=>[(d(),$(ee,null,Le(F,s=>a(e(se),{key:s.id,"data-ark-data-list-item":"",size:"s",appearance:"menu-option","icon-right":s.name===C.value?"check":void 0,onClick:f=>x.value=s.id},{default:r(()=>[y(w(s.name),1)]),_:2},1032,["icon-right","onClick"])),64))]),_:1})]),default:r(()=>[a(e(se),{appearance:"white",size:"xs",icon:"lang"},{default:r(()=>[y(w(C.value),1)]),_:1})]),_:1})],2)):W("",!0)],10,Ya),t("div",{class:n(_.$style.content)},[t("div",{class:n(["ark-space_bottom-4",_.$style.stepper])},[t("p",{class:n(_.$style.stepper__item),"data-current":!1,"data-done":!0},[(d(),oe(e(X),{key:0,name:"check",class:n(_.$style.stepper__count)},null,8,["class"])),y(" Пожелания ")],2),t("p",{class:n(_.$style.stepper__item),"data-current":!0,"data-done":!!te.value},[te.value?(d(),oe(e(X),{key:0,name:"check",class:n(_.$style.stepper__count)},null,8,["class"])):(d(),$("span",{key:1,class:n(_.$style.stepper__count)}," 2 ",2)),y(" Подтверждение ")],10,es)],2),a(Ae,{name:"ark-list-right-transition"},{default:r(()=>[t("div",{class:n(_.$style.animationBoundary)},[t("h6",ts,w(_.$t("queue.contact")),1),t("button",{style:{color:"var(--ark-text-color-80)",display:"inline-flex"},class:n(["ark-space_bottom-4",_.$style.inline]),type:"button",onClick:D[0]||(D[0]=s=>L.value=0)},[a(e(X),{name:"arrow-left",size:16}),y(" Изменить ")],2),t("form",{onSubmit:Me(ne,["prevent"])},[a(e(ae),{class:"ark-space_bottom-4",control:e(N).phone},{default:r(({model:s})=>[a(e(ot),{modelValue:s.value,"onUpdate:modelValue":f=>s.value=f,required:"",size:"l","has-cleaner":!1,label:_.$t("phone")},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},8,["control"]),a(e(ae),{class:"ark-space_bottom-4",control:e(N).name},{default:r(({model:s})=>[a(e(De),{modelValue:s.value,"onUpdate:modelValue":f=>s.value=f,size:"l",label:_.$t("name"),"has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},8,["control"]),a(e(se),{type:"submit",style:{width:"100%"},size:"l",loading:J.value},{default:r(()=>[y(w(_.$t("confirm")),1)]),_:1},8,["loading"])],32)],2)]),_:1})],2)],64)}}}),ss="_imageContainer_1j9nu_1",ns="_imageContainer__content_1j9nu_17",ls="_stepper_1j9nu_41",os="_stepper__item_1j9nu_48",is="_stepper__count_1j9nu_69",rs="_image_1j9nu_1",us="_content_1j9nu_93",cs="_label_1j9nu_109",_s="_animationBoundary_1j9nu_115",ds="_buttons_1j9nu_120",ms="_language_1j9nu_128",ps="_notification_1j9nu_138",fs="_tabs_1j9nu_175",vs="_eta_1j9nu_181",gs="_submit_1j9nu_186",ys="_inline_1j9nu_195",ks={imageContainer:ss,imageContainer__content:ns,stepper:ls,stepper__item:os,stepper__count:is,image:rs,content:us,label:cs,animationBoundary:_s,buttons:ds,language:ms,notification:ps,tabs:fs,eta:vs,submit:gs,inline:ys},hs={$style:ks},bs=ye(as,[["__cssModules",hs]]),$s=["data-fixed"],ws=["src","alt"],Ss={class:"ark-text_h6 ark-space_bottom-3"},Vs=["innerHTML"],Cs=["innerHTML"],Ls=ge({__name:"Third",props:{restId:{},showLang:{type:Boolean,default:!0},fullfillPhone:{default:""},fixed:{type:Boolean,default:!0}},setup(G){const j=G,F=[{id:"ru",name:"Русский"},{id:"en",name:"English"},{id:"zh",name:"中国人"}],H=Oe(),c=Se(),m=qe(),x=m.locale;u(!1),u(0);const L=u(!1);u(!1);const q=localStorage.getItem("__airestro_phone"),J=localStorage.getItem("__airestro_name"),S=typeof q=="string"&&$e(q).length===11?we(q):"+7",P=typeof J=="string"?J:null,Q=Ve({phone:["+7",{required:fe,phone:Re(!0)}],name:[P]});ze(je,{required:"validators.phone",phone:"validators.required"});const B=u(null),N=u(2);u("");const o=u([]),p=u(null);u(null);const V=["минута","минуты","минут"],ie=b(()=>{const l=x.value;return F.find(O=>O.id===l).name}),te=b(()=>{const l=be(N.value,2,8),U=o.value.find(D=>D.num_people>=l);if(!U)return"...";const ne=be(U.time_difference_minutes,0,1/0),me=R.fromAbsoluteMilliseconds(ne*Be),_=ve(V,me.minutes);return me.hours?m.t("1_hour"):`${me.minutes} ${_}`});function Y(l){if(!l)return"";const[O,U]=l.split("+"),ne=new Date(O).valueOf(),me=new Date(new Date().toLocaleString("en",{timeZone:`+${U}`})).valueOf(),{hours:_,minutes:D}=R.fromAbsoluteMilliseconds(be(ne-me,0,at-1));return _!==0?m.t("1_hour"):m.t("queue_minutes",{minutes:D})}b(()=>{const l=p.value;if(l){const O=te.value;return{time:Y(l.seating_time)||O}}return{time:""}});const v=b(()=>L.value?null:B.value),C=b(()=>{const l=v.value;let O=l==null?void 0:l.opening_time,U=l==null?void 0:l.closing_time;return!O||!U?"":(O=R.fromString(O).toString("HH:MM"),U=R.fromString(U).toString("HH:MM"),`${O} - ${U}`)});pe(()=>j.restId,l=>{L.value=!0,H.loadRestaurant.execute({id:l}).then(O=>{B.value=O}).catch(()=>{c.show("resto.error_text",{type:"error",label:"resto.error_title"})}).finally(()=>{L.value=!1})},{immediate:!0});let g=null;return pe(p,(l,O,U)=>{U(()=>{g&&clearTimeout(g)}),l&&(g=setTimeout(()=>{H.queueInfo.execute({id:l.id}).then(ne=>{ne&&(p.value=ne)})},30*st))}),pe(()=>j.restId,l=>{document.documentElement.setAttribute("data-rest",l)},{immediate:!0}),pe(()=>j.fullfillPhone,l=>{Q.phone.setValue(l?we(l):S)},{immediate:!0}),(l,O)=>{var U;return d(),$(ee,null,[t("div",{class:n(l.$style.imageContainer),"data-fixed":l.fixed},[L.value?(d(),$("div",{key:1,class:n(["ark-skeleton",l.$style.image])},null,2)):(d(),$(ee,{key:0},[B.value&&B.value.link_to_image?(d(),$("img",{key:0,src:B.value.link_to_image,class:n(l.$style.image),alt:B.value.name},null,10,ws)):W("",!0)],64)),t("div",{class:n(l.$style.imageContainer__content)},[t("h1",{class:n(["ark-text_h5 ark-space_bottom-2",L.value&&"ark-skeleton"])},w(L.value?"Stub stub stub":(U=B.value)==null?void 0:U.name),3),t("p",{class:n(["ark-text_body-s",L.value&&"ark-skeleton"])},w(l.$t("working"))+" "+w(L.value?"Stub stub":C.value),3)],2),l.showLang?(d(),$("div",{key:2,class:n(l.$style.language)},[a(e(Ue),{"min-width":144},{dropdown:r(()=>[a(e(Ee),null,{default:r(()=>[(d(),$(ee,null,Le(F,ne=>a(e(se),{key:ne.id,"data-ark-data-list-item":"",size:"s",appearance:"menu-option","icon-right":ne.name===ie.value?"check":void 0,onClick:me=>x.value=ne.id},{default:r(()=>[y(w(ne.name),1)]),_:2},1032,["icon-right","onClick"])),64))]),_:1})]),default:r(()=>[a(e(se),{appearance:"white",size:"xs",icon:"lang"},{default:r(()=>[y(w(ie.value),1)]),_:1})]),_:1})],2)):W("",!0)],10,$s),t("div",{class:n(l.$style.content)},[t("div",{class:n(["ark-space_bottom-4",l.$style.stepper])},[t("p",{class:n(l.$style.stepper__item),"data-current":!1,"data-done":!0},[(d(),oe(e(X),{key:0,name:"check",class:n(l.$style.stepper__count)},null,8,["class"])),y(" Пожелания ")],2),t("p",{class:n(l.$style.stepper__item),"data-current":!0,"data-done":!0},[(d(),oe(e(X),{key:0,name:"check",class:n(l.$style.stepper__count)},null,8,["class"])),y(" Подтверждение ")],2)],2),a(Ae,{name:"ark-list-right-transition"},{default:r(()=>[t("div",null,[t("h6",Ss,w(l.$t("success")),1),t("div",{class:n(["ark-space_bottom-2",l.$style.notification]),"data-status":"success"},[a(e(X),{size:20,name:"check"}),t("p",{innerHTML:l.$t("your_queue_number",{number:1})},null,8,Vs)],2),t("p",{innerHTML:l.$t("queue.success_text"),class:"ark-space_bottom-6"},null,8,Cs)])]),_:1})],2)],64)}}}),Ms="_imageContainer_1j9nu_1",zs="_imageContainer__content_1j9nu_17",Ns="_stepper_1j9nu_41",Ds="_stepper__item_1j9nu_48",Is="_stepper__count_1j9nu_69",Ts="_image_1j9nu_1",As="_content_1j9nu_93",Bs="_label_1j9nu_109",Us="_animationBoundary_1j9nu_115",js="_buttons_1j9nu_120",qs="_language_1j9nu_128",Os="_notification_1j9nu_138",Es="_tabs_1j9nu_175",Rs="_eta_1j9nu_181",Fs="_submit_1j9nu_186",Ps="_inline_1j9nu_195",Hs={imageContainer:Ms,imageContainer__content:zs,stepper:Ns,stepper__item:Ds,stepper__count:Is,image:Ts,content:As,label:Bs,animationBoundary:Us,buttons:js,language:qs,notification:Os,tabs:Es,eta:Rs,submit:Fs,inline:Ps},Js={$style:Hs},xs=ye(Ls,[["__cssModules",Js]]),Qs={allowDelete:!0,sizeDecimals:0,progressMax:100,size:"md"},Zs=["src"],Gs=ge({name:"FilePreview",__name:"FilePreview",props:ut({state:{},file:{},allowDelete:{type:Boolean},sizeDecimals:{},progressValue:{},progressMax:{},size:{}},Qs),emits:["onDelete","onRepeat"],setup(G,{emit:j}){const H=G,c=j,{file:m,sizeDecimals:x,state:L}=nt(H),q={format:"Неверный формат файла",size:"Превышен максимальный размер файла"},J=b(()=>{const o=m.value;return o&&o.errorReason?q[o.errorReason]||o.errorReason:"Ошибка загрузки"}),S=b(()=>{const o=m.value;if(o instanceof File&&kt(o,"image/*"))return URL.createObjectURL(o)}),P=b(()=>{const o=m.value;return o!=null&&o.src?"a":"div"}),Q=b(()=>{const o=m.value&&m.value;if(!o||!o.size)return"";const p=x.value;return Ct(o.size,p)}),B=()=>{c("onDelete")},N=()=>{c("onRepeat")};return(o,p)=>(d(),oe(mt(P.value),{ref:"noreferrer noopener",target:"_blank",class:n([o.$style.file,P.value==="a"&&o.$style.file_link,o.$style["file_"+o.size]]),href:P.value==="a"?e(m).src:void 0},{default:r(()=>[ct(o.$slots,"preview",{},()=>[S.value||e(m).src?(d(),$("img",{key:0,alt:"Превью файла",class:n(["ark-space_right-3",o.$style.localImage]),src:e(m).src?e(m).src:S.value},null,10,Zs)):W("",!0)]),t("div",{class:n([o.$style.content,(S.value||e(m).src)&&o.$style.content_preview])},[t("p",{class:n(["ark-text_body-sm ark-text_medium",o.$style.filename,e(L)==="error"&&o.$style.error])},[e(L)!=="error"?(d(),$(ee,{key:0},[y(w(e(m).name),1)],64)):(d(),$(ee,{key:1},[y(w(J.value),1)],64))],2),e(L)?e(L)==="error"?(d(),$("a",{key:1,tabindex:"0",class:n(["ark-text_body-xs ark-text_medium",o.$style.repeat]),onClick:Me(N,["prevent"])}," Повторить ",2)):e(L)==="loading"?(d(),oe(e(St),{key:2,class:n(o.$style.progress),size:"s",value:o.progressValue,max:o.progressMax},null,8,["class","value","max"])):W("",!0):(d(),$(ee,{key:0},[e(m).size?(d(),$("p",{key:0,class:n(["ark-text_body-xs",o.$style.size])},w(Q.value),3)):W("",!0)],64))],2),o.allowDelete?tt((d(),$("button",{key:0,"aria-label":"Удалить файл",title:"Удалить файл",class:n(o.$style.close),onClick:Me(B,["stop","prevent"])},[a(e(dt),{name:"close",size:20})],2)),[[e(_t)]]):W("",!0)]),_:3},8,["class","href"]))}}),Ks="_file_s892g_1",Ws="_file_link_s892g_14",Ys="_file_sm_s892g_18",Xs="_file_md_s892g_23",en="_localImage_s892g_29",tn="_filename_s892g_43",an="_error_s892g_51",sn="_size_s892g_55",nn="_content_s892g_59",ln="_content_preview_s892g_65",on="_repeat_s892g_69",rn="_progress_s892g_73",un="_close_s892g_79",cn={file:Ks,file_link:Ws,file_sm:Ys,file_md:Xs,localImage:en,filename:tn,error:an,size:sn,content:nn,content_preview:ln,repeat:on,progress:rn,close:un},_n={$style:cn},Ye=ye(Gs,[["__cssModules",_n]]),dn={class:"ark-text_medium"},mn=t("br",null,null,-1),pn=t("a",null,"Или выберите файл",-1),fn=ge({__name:"UploadFont",props:{restaurant:{},modelValue:{},weight:{}},emits:["update:modelValue"],setup(G,{emit:j}){const F=G,H=j,{modelValue:c}=nt(F),m=lt(),x=Se(),L=u(null),q=S=>{if(!S){L.value=null;return}const P=Array.isArray(S)?S[0]:S;L.value=P;const Q=new FormData;Q.set("file",P),Q.set("restaurant",F.restaurant),m.uploadFont.execute(Q).then(B=>{B&&(H("update:modelValue",{weight:F.weight,sameAs:!1,file:B.link,filename:B.name,id:B.id,size:B.size}),L.value=null)}).catch(([B])=>{x.show(JSON.stringify(B),{label:"Ошибка загрузки шрифта",type:"error"}),L.value=null})},J=b(()=>{const S=c.value;return!S||!S.filename||!S.file?null:{name:S.filename,src:S.file,size:S.size}});return(S,P)=>J.value?(d(),oe(e(Ye),{key:1,size:"sm",file:J.value,onOnDelete:P[0]||(P[0]=Q=>H("update:modelValue",null))},{preview:r(()=>[t("div",{class:n(S.$style.preview)},[a(e(He),{name:"font"})],2)]),_:1},8,["file"])):(d(),$(ee,{key:0},[a(e(ht),{"model-value":L.value,"onUpdate:modelValue":q},{default:r(()=>[t("p",dn,[y(" Перетащите файл для шрифта"),mn,y(" жирности "+w(S.weight),1)]),pn]),_:1},8,["model-value"]),L.value?(d(),oe(e(Ye),{key:0,class:"ark-space_top-2",state:"loading",size:"sm",file:L.value},{preview:r(()=>[t("div",{class:n(S.$style.preview)},[a(e(He),{name:"font"})],2)]),_:1},8,["file"])):W("",!0)],64))}}),vn="_preview_2go0e_1",gn={preview:vn},yn={$style:gn},Ne=ye(fn,[["__cssModules",yn]]),kn=t("h6",{class:"ark-text_h6 ark-space_bottom-3"},"Шрифт",-1),hn={class:"ark-group ark-group_row ark-space_bottom-3",style:{"--ark-group-radius":"var(--ark-radius-m)"}},bn=t("a",{href:"https://fonts.google.com/specimen/Inter",target:"_blank"}," Inter шрифт ",-1),$n={key:1,class:"ark-table"},wn=t("thead",null,[t("tr",null,[t("th",null,"Жирность шрифта"),t("th",null,"Файл")])],-1),Sn=t("td",null,"400",-1),Vn=t("td",null,[t("span",{class:"ark-text_medium"},"500")],-1),Cn=t("td",null,[t("span",{class:"ark-text_semibold"},"600")],-1),Ln=t("td",null,[t("span",{class:"ark-text_bold"},"700")],-1),Mn=ge({__name:"InputFonts",props:{restaurant:{},fonts:{},initial:{}},emits:["update:fonts"],setup(G,{emit:j}){const F=G,H=j,c=u("google"),m=Ve({400:[null],500:[null],600:[null],700:[null],same_as_400:[!0],same_as_500:[!0],same_as_600:[!0]});pe(()=>F.initial,N=>{N.length===0?c.value="google":(c.value="custom",N.forEach((o,p)=>{if(p>0){const V=`same_as_${N[p-1].weight}`;m[V].setValue(o.sameAs)}console.log(o),!o.sameAs&&o.file&&m[o.weight].setValue(o)}))},{immediate:!0});const x=m[400].value,L=m[500].value,q=m[600].value,J=m[700].value,S=m.same_as_400.value,P=m.same_as_500.value,Q=m.same_as_600.value,B=b(()=>{if(c.value==="google")return[];const N=x.value,o=L.value,p=q.value,V=J.value,ie=S.value,te=P.value,Y=Q.value;return[{id:(N==null?void 0:N.id)??null,weight:400,sameAs:!1},{id:(o==null?void 0:o.id)??null,weight:500,sameAs:ie},{id:(p==null?void 0:p.id)??null,weight:600,sameAs:te},{id:(V==null?void 0:V.id)??null,weight:700,sameAs:Y}]});return pe(B,N=>{H("update:fonts",N)}),(N,o)=>(d(),$("div",null,[kn,t("div",hn,[a(e(se),{size:"s",type:"button",appearance:c.value==="google"?"primary":"neutral",onClick:o[0]||(o[0]=p=>c.value="google")},{default:r(()=>[y(" Airesto ")]),_:1},8,["appearance"]),a(e(se),{size:"s",type:"button",appearance:c.value==="custom"?"primary":"neutral",onClick:o[1]||(o[1]=p=>c.value="custom")},{default:r(()=>[y(" Собственные ")]),_:1},8,["appearance"])]),c.value==="google"?(d(),$(ee,{key:0},[y(" Airesto использует "),bn],64)):c.value==="custom"?(d(),$("div",$n,[t("table",null,[wn,t("tbody",null,[t("tr",null,[Sn,t("td",null,[a(e(ae),{class:"ark-space_top-2",control:e(m)[400]},{default:r(({model:p})=>[a(Ne,{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V,restaurant:N.restaurant,weight:400},null,8,["modelValue","onUpdate:modelValue","restaurant"])]),_:1},8,["control"])])]),t("tr",null,[Vn,t("td",null,[a(e(ae),{control:e(m).same_as_400},{default:r(({model:p})=>[a(e(Fe),null,{default:r(()=>[a(e(Pe),{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V},null,8,["modelValue","onUpdate:modelValue"]),y(" Такой же как 400 ")]),_:2},1024)]),_:1},8,["control"]),e(m).same_as_400.value.value?W("",!0):(d(),oe(e(ae),{key:0,class:"ark-space_top-2",control:e(m)[500]},{default:r(({model:p})=>[a(Ne,{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V,restaurant:N.restaurant,weight:500},null,8,["modelValue","onUpdate:modelValue","restaurant"])]),_:1},8,["control"]))])]),t("tr",null,[Cn,t("td",null,[a(e(ae),{control:e(m).same_as_500},{default:r(({model:p})=>[a(e(Fe),null,{default:r(()=>[a(e(Pe),{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V},null,8,["modelValue","onUpdate:modelValue"]),y(" Такой же как 500 ")]),_:2},1024)]),_:1},8,["control"]),e(m).same_as_500.value.value?W("",!0):(d(),oe(e(ae),{key:0,class:"ark-space_top-4",control:e(m)[600]},{default:r(({model:p})=>[a(Ne,{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V,restaurant:N.restaurant,weight:600},null,8,["modelValue","onUpdate:modelValue","restaurant"])]),_:1},8,["control"]))])]),t("tr",null,[Ln,t("td",null,[a(e(ae),{control:e(m).same_as_600},{default:r(({model:p})=>[a(e(Fe),null,{default:r(()=>[a(e(Pe),{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V},null,8,["modelValue","onUpdate:modelValue"]),y(" Такой же как 600 ")]),_:2},1024)]),_:1},8,["control"]),e(m).same_as_600.value.value?W("",!0):(d(),oe(e(ae),{key:0,class:"ark-space_top-2",control:e(m)[700]},{default:r(({model:p})=>[a(Ne,{modelValue:p.value,"onUpdate:modelValue":V=>p.value=V,restaurant:N.restaurant,weight:700},null,8,["modelValue","onUpdate:modelValue","restaurant"])]),_:1},8,["control"]))])])])])])):W("",!0)]))}}),zn=["value"],Nn=ge({__name:"InputColor",props:{modelValue:{}},emits:["update:modelValue"],setup(G,{emit:j}){const F=j,H={mask:["#",...new Array(6).fill(/[0-9a-f]/i)]};return(c,m)=>(d(),oe(e(De),{"model-value":c.modelValue,"has-cleaner":!1,"mask-options":H,"onUpdate:modelValue":m[1]||(m[1]=x=>F("update:modelValue",x||""))},{right:r(()=>[t("div",{class:n(c.$style.picker)},[t("input",{type:"color",value:c.modelValue,class:n(c.$style.input),onInput:m[0]||(m[0]=x=>F("update:modelValue",x.target.value))},null,42,zn),a(e(He),{name:"color"}),t("div",{class:n(c.$style.hr),style:Je({background:c.modelValue})},null,6)],2)]),_:1},8,["model-value"]))}}),Dn="_picker_17nxw_1",In="_input_17nxw_10",Tn="_hr_17nxw_22",An={picker:Dn,input:In,hr:Tn},Bn={$style:An},Ce=ye(Nn,[["__cssModules",Bn]]),Un={class:"ark-space_bottom-6",style:{"max-width":"640px"}},jn=t("h4",{class:"ark-text_h4 ark-space_bottom-1"},"Стилизация",-1),qn=t("p",{class:"ark-text_body-s ark-space_bottom-4"},[y(" Стили применяются к "),t("b",null,"Бронированию"),y(", "),t("b",null,"Живой очереди"),y(" и "),t("b",null,"Телеграму"),y(" внутри сети ресторана ")],-1),On=t("h6",{class:"ark-text_h6 ark-space_bottom-3"},"Палитра",-1),En={class:"ark-group ark-group_row ark-space_bottom-3",style:{width:"100%"}},Rn={class:"ark-group ark-group_row ark-space_bottom-3",style:{width:"100%"}},Fn=t("h6",{class:"ark-text_h6 ark-space_bottom-2"},"Бронирование",-1),Pn={style:{position:"relative",flex:"1",isolation:"isolate"}},Hn={style:{position:"relative",flex:"1",isolation:"isolate"}},Jn={style:{position:"relative",flex:"1",isolation:"isolate"}},xn=t("h6",{class:"ark-text_h6 ark-space_bottom-2 ark-space_top-4"},"Живая очередь",-1),Qn={style:{position:"relative",flex:"1",isolation:"isolate"}},Zn={style:{position:"relative",flex:"1",isolation:"isolate"}},Gn={style:{position:"relative",flex:"1",isolation:"isolate"}},Kn={style:{"text-align":"center"}},Wn=t("h6",{class:"ark-text_h6 ark-space_bottom-2"},"Изменения применятся сразу",-1),Yn=t("p",{class:"ark-space_bottom-6"}," Уверены что все устраивает и готовы сохранить? ",-1),Xn=ge({__name:"Theme",props:{id:{}},setup(G){const j=G,F=lt(),H=Se(),c=Ve({primary:["#007aff",{required:fe}],primaryText:["#ffffff",{required:fe}],text:["#111111",{required:fe}],background:["#ffffff",{required:fe}],inputBackground:["#F5F7FA",{required:fe}],fonts:[[]]}),m=u([]),x=()=>{c.primary.setValue("#007aff"),c.primaryText.setValue("#ffffff"),c.text.setValue("#111111"),c.background.setValue("#ffffff"),c.inputBackground.setValue("#F5F7FA")},L=u(!1),q=u(!1);ze(gt,yt);function J(v){v=v.replace(/^#/,""),v.length===3&&(v=v.split("").map(U=>U+U).join(""));const C=parseInt(v,16),g=C>>16&255,l=C>>8&255,O=C&255;return[g,l,O]}function S(v){v=v.replace(/^#/,"");const C=parseInt(v.substring(0,2),16),g=parseInt(v.substring(2,4),16),l=parseInt(v.substring(4,6),16);return .299*C+.587*g+.114*l>186}const P=["96","80","64","56","48","32","24","16","12","08","04","00"];function Q([v,C,g],l){return P.reduce((O,U)=>(O[`--ark-${l}-${U}`]=`rgba(${v},${C},${g},0.${U})`,O),{})}const B=c.background.value,N=c.text.value,o=c.primary.value,p=c.primaryText.value,V=c.inputBackground.value,ie=b(()=>{const v=J(B.value),C=J(N.value),g=S(B.value),l={"--ark-background-color":`rgb(${v.join(",")})`,...Q(v,"background-color"),"--ark-text-color":`rgb(${C.join(",")})`,...Q(C,"text-color"),"--ark-primary":o.value,"--ark-primary-text":`rgb(${J(p.value).join(",")})`,"--ark-grey-c":`rgb(${J(V.value).join(",")})`,"--ark-error-bg":"#ce372d1f","--ark-error-fill":"#ce372d","--ark-success-bg":"#4ac99b1f","--ark-success-fill":"#4ac99b",color:"var(--ark-text-color)",background:"var(--ark-background-color)"};return g||(l["--ark-error-bg"]="#ff8c6752",l["--ark-error-fill"]="#ff8c67",l["--ark-success-bg"]="#4ac99b52",l["--ark-success-fill"]="#4ac99b"),l});pt(()=>{F.plainPalette.execute({restaurant:Number(j.id)}).then(v=>{v&&(v.css_variable&&(c.primary.setValue(v.css_variable.primary),c.primaryText.setValue(v.css_variable.primary_text),c.text.setValue(v.css_variable.text),c.background.setValue(v.css_variable.background),c.inputBackground.setValue(v.css_variable.input_background)),m.value=v.fonts.map(C=>({weight:C.weight,sameAs:C.same_as,file:C.file,filename:C.filename,id:C.id,size:C.size})))})});const te=()=>{c.validate(),c.valid.value&&(L.value=!0)},Y=()=>{if(c.validate(),c.invalid.value)return;q.value=!0;const v=c.getCurrentValue();console.log(JSON.stringify({...v,restaurant:Number(j.id)})),F.savePalette.execute({...v,restaurant:Number(j.id)}).then(()=>{H.show("Можешь проверять изменения",{label:"Палитра сохранена"}),L.value=!1}).catch(()=>{H.show("Попробуй еще раз",{type:"error",label:"Не удалось обновить палитру"})}).finally(()=>{q.value=!1})};return(v,C)=>(d(),$(ee,null,[t("div",Un,[jn,qn,t("form",{onSubmit:Me(te,["prevent"])},[a(e(ae),{control:e(c).fonts},{default:r(({model:g})=>[a(Mn,{fonts:g.value,"onUpdate:fonts":l=>g.value=l,class:"ark-space_bottom-6",initial:m.value,restaurant:v.id},null,8,["fonts","onUpdate:fonts","initial","restaurant"])]),_:1},8,["control"]),On,t("div",En,[a(e(ae),{style:{flex:"1"},control:e(c).background},{default:r(({model:g})=>[a(Ce,{modelValue:g.value,"onUpdate:modelValue":l=>g.value=l,label:"Цвет фона",size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),a(e(ae),{style:{flex:"1"},control:e(c).text},{default:r(({model:g})=>[a(Ce,{modelValue:g.value,"onUpdate:modelValue":l=>g.value=l,label:"Цвет текста",size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"])]),a(e(ae),{style:{flex:"1"},class:"ark-space_bottom-4",control:e(c).inputBackground},{default:r(({model:g})=>[a(Ce,{modelValue:g.value,"onUpdate:modelValue":l=>g.value=l,label:"Цвет фона полей ввода",style:{width:"100%"},size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),t("div",Rn,[a(e(ae),{style:{flex:"1"},control:e(c).primary},{default:r(({model:g})=>[a(Ce,{modelValue:g.value,"onUpdate:modelValue":l=>g.value=l,label:"Акцентный цвет",size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),a(e(ae),{style:{flex:"1"},control:e(c).primaryText},{default:r(({model:g})=>[a(Ce,{modelValue:g.value,"onUpdate:modelValue":l=>g.value=l,label:"Текст на акценте",size:"l"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"])]),a(e(se),{type:"submit"},{default:r(()=>[y("Сохранить")]),_:1}),a(e(se),{class:"ark-space_left-2",appearance:"flat",type:"button",onClick:x},{default:r(()=>[y(" Airesto палитра ")]),_:1})],32)]),Fn,t("div",{style:Je([{display:"flex",gap:"1rem","align-items":"flex-start"},ie.value])},[t("div",Pn,[a(bt,{"rest-id":v.id,fixed:!1},null,8,["rest-id"])]),t("div",Hn,[a(da,{"rest-id":v.id,fixed:!1},null,8,["rest-id"])]),t("div",Jn,[a(Wa,{"rest-id":v.id,fixed:!1},null,8,["rest-id"])])],4),xn,t("div",{style:Je([{display:"flex",gap:"1rem","align-items":"flex-start"},ie.value])},[t("div",Qn,[a($t,{"rest-id":v.id,fixed:!1},null,8,["rest-id"])]),t("div",Zn,[a(bs,{"rest-id":v.id,fixed:!1},null,8,["rest-id"])]),t("div",Gn,[a(xs,{"rest-id":v.id,fixed:!1},null,8,["rest-id"])])],4),a(e(vt),{modelValue:L.value,"onUpdate:modelValue":C[0]||(C[0]=g=>L.value=g),size:"sm"},{default:r(({close:g})=>[t("div",Kn,[a(e(ft),{type:"warning",class:"ark-space_bottom-6"}),Wn,Yn,a(e(se),{class:"ark-space_bottom-2",style:{width:"100%"},size:"l",loading:q.value,onClick:Y},{default:r(()=>[y(" Да, сохранить ")]),_:1},8,["loading"]),a(e(se),{appearance:"neutral",style:{width:"100%"},size:"l",onClick:g},{default:r(()=>[y(" Нет, подожди ")]),_:2},1032,["onClick"])])]),_:1},8,["modelValue"])],64))}}),el="_scrollbar_1rqlm_1",tl={scrollbar:el},al={$style:tl},vl=ye(Xn,[["__cssModules",al]]);export{vl as default};
