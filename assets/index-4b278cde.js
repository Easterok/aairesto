import{d as Ie,a3 as Ge,y as Te,b as m,o as l,c as u,q as pe,k as e,W as We,l as B,a as s,t as L,j as h,F as T,g as ie,n as r,h as c,S as Dt,aa as nt,$ as H,a0 as we,Z as fe,b5 as Gt,a2 as Ee,aj as Lt,aO as Et,b6 as Mt,_ as Be,aN as dt,r as R,w as ye,a7 as st,aC as Ue,s as mt,A as W,i as $,aP as Vt,al as rt,b7 as Kt,u as _t,m as vt,Q as Ye,E as qe,b8 as wt,C as it,U as Yt,z as St,a1 as Fe,ai as It,ab as Qt,ac as ea,aD as ta,b9 as aa,T as Me,ax as sa,af as ut,aL as pt,a9 as He,ba as na,aF as Ot,aG as Je,P as la,aM as oa,bb as ra,v as ia,x as ua,bc as ca,aq as Qe,aK as zt,ah as Ct,ad as et,Y as da,bd as ma}from"./index-4bb58793.js";import{O as _a,I as Tt,M as va}from"./index-6eaad6eb.js";import{T as tt}from"./index-0ed1445d.js";import{T as jt}from"./index-bdf865c9.js";import{c as At,p as Bt,s as pa}from"./index-d4739dd9.js";import{c as Pt,r as at,s as fa,_ as Ze,b as ba}from"./index-32116540.js";import{I as ya,_ as ga}from"./index-3a4af7ab.js";import{F as ka}from"./index-d9c5e50f.js";import{v as ha,a as $a,S as xa,T as wa,Z as Sa}from"./index-80443b79.js";import{u as Oa}from"./index-ee039805.js";import"./index-fe4132e1.js";import"./index-bc918f74.js";import"./index-176adada.js";const za=["data-conf"],Ca=s("p",{class:"ark-text_body-xs ark-text_semibold ark-space_bottom-1"}," Новое бронирование ",-1),Ta={class:"ark-text_semibold"},Na={class:"ark-text_body-xs ark-space_bottom-2"},Da={class:"ark-text_body-xs ark-text_64"},La={class:"ark-text_body-xs"},Ea=Ie({__name:"SelectedPreview",props:{vertical:{},horizontal:{},tables:{},time:{},conf:{type:Boolean}},setup(ue){const de=ue,{vertical:x,horizontal:E,tables:Y,time:te}=Ge(de),G=Te(nt),V=m(()=>{const f=x.value;return f?f.start.time.toJSON():null}),ae=m(()=>{const f=x.value;if(!f)return null;const y=f.end.time.valueOf(),D=new Date(y+Ee*15),se=new H(we.fromLocalNativeDate(D),fe.fromLocalNativeDate(D));return`${f.start.time.time.toString("HH:MM")} ${Gt} ${se.time.toString("HH:MM")}`}),Q=m(()=>{const f=E.value,y=Y.value,D=Object.keys(y);if(!f)return[];const{start:se,end:oe}=f,J=[];let re=!1;for(let le=0;le<D.length;le++){const ce=y[D[le]];if(!re&&ce.id===se.column&&(re=!0),re&&(J.push({id:ce.id,num:ce.number,zone:ce.zone,cap:ce.capacity}),ce.id===oe.column))break}return J}),q=m(()=>Q.value.reduce((f,y)=>f+y.cap,0)),ee=m(()=>{const f=x.value;if(!f)return null;const{start:y,end:D}=f,se=y.time.valueOf();let oe=D.time.valueOf()+Ee*15;return oe<se&&(oe+=Mt),fe.fromAbsoluteMilliseconds(oe-se)}),N=["час","часа","часов"],F=m(()=>{const f=ee.value;if(!f)return"";const y=[];return f.hours!==0&&y.push(`${f.hours} ${Lt(N,f.hours)}`),f.minutes!==0&&y.push(`${f.minutes} мин`),y.join(Et)}),I=m(()=>{const f=Q.value;if(!f[0])return[];const y=f[0].zone,D=[];f.every(re=>re.zone===y)||D.push("Столы из разных зон");const se=x.value,oe=te.value;se&&se.start.time.valueOf()<oe.valueOf()&&D.push("Время начала в прошлом");const J=G.value;return se&&J&&se.start.time.valueOf()<new H(se.start.time.day,fe.fromString(J.opening_time)).valueOf()&&D.push("Время начала до открытия"),D});return(f,y)=>(l(),u("div",{class:r(f.$style.root),"data-conf":f.conf},[Ca,V.value?(l(),pe(e(We),{key:0,today:"",mask:"[day:numeric] [month:long] [year:numeric]",class:"ark-text_body-xs",date:V.value},null,8,["date"])):B("",!0),s("p",Ta,L(ae.value),1),s("p",Na,L(F.value),1),s("p",Da,[h(" Столы "),(l(!0),u(T,null,ie(Q.value,D=>(l(),u("span",{key:D.id,class:r(f.$style.table)},L(D.num),3))),128))]),s("p",La,[h(" На "),s("b",null,L(q.value)+" чел",1)]),I.value.length>0?(l(),u("div",{key:1,class:r(["ark-space_top-2",f.$style.notification])},[(l(!0),u(T,null,ie(I.value,D=>(l(),u("p",{key:D,class:r(f.$style.notification__text)},[c(e(Dt),{name:"warning",style:{color:"var(--supra-attention-color)"},size:12}),h(" "+L(D),1)],2))),128))],2)):B("",!0)],10,za))}}),Ma="_root_a4i85_1",Va="_table_a4i85_13",Ia="_notification_a4i85_27",ja="_notification__text_a4i85_38",Aa={root:Ma,table:Va,notification:Ia,notification__text:ja},Ba={$style:Aa},Ut=Be(Ea,[["__cssModules",Ba]]),Pa=["data-show-hidden"],Ua={style:{position:"absolute","z-index":"-1",top:"40px",left:"-4px"}},Xa=["data-col","data-time"],Ra=["data-col","data-time"],qa=["data-id","data-high","data-type","data-selection","data-airesto","onClick"],Ha=s("p",null,"Жду следующую",-1),Nt=32,Fa=Ie({__name:"MobileTimesheet",props:{timeSegments:{},tables:{},data:{},highlight:{},count:{},addEnabled:{type:Boolean},freezLoading:{type:Boolean}},emits:["add","show","freez"],setup(ue,{emit:de}){dt(n=>({"0c0074c4":A.value}));const x=ue,E=de,{timeSegments:Y,data:te,tables:G,count:V,addEnabled:ae}=Ge(x),Q=Te(Vt),q=R(128),ee=R(null),N=R(null),F=R(!1),I=R(!1),f=R(null),y=m(()=>Q.value.native);let D=null;ye([ee,V],([n],d,b)=>{if(b(()=>{D&&clearTimeout(D),D=null}),n){const S=Array.isArray(n)?n[0]:n;D=setTimeout(()=>{q.value=S.clientWidth})}},{immediate:!0});const se=m(()=>Y.value.reduce((d,b)=>{const S=new Date(b.valueOf()+Ee*15),t=new H(we.fromLocalNativeDate(S),fe.fromLocalNativeDate(S)),_={a:b,b:t};return d.push(_),d},[])),oe=m(()=>G.value.reduce((d,b,S)=>(d[b.id]=S,d),{})),J=m(()=>G.value.reduce((d,b)=>(d[b.id]=b,d),{})),re=m(()=>{const n=f.value;if(!n)return null;const{start:d,end:b}=n,S=d.time.valueOf(),t=b.time.valueOf(),_=Math.abs(S-t)/(Ee*15);return d.time.valueOf()>b.time.valueOf()?{start:b,end:d,diff:_}:{start:d,end:b,diff:_}}),le=m(()=>{const n=f.value;if(!n)return null;const{start:d,end:b}=n,S=oe.value,t=S[d.column],_=S[b.column],v=Math.abs(t-_);return t<_?{start:d,end:b,diff:v}:{start:b,end:d,diff:v}}),ce=m(()=>{const n=le.value;return n?`${(n.diff+1)*q.value}px`:"0px"}),Se=m(()=>{const n=re.value;return n?`${(n.diff+1)*(Nt/2)}px`:"0px"}),Ne=m(()=>{const n=le.value,d=oe.value;return n?`${d[n.start.column]*q.value}px`:"0px"}),Ve=m(()=>{const n=se.value[0],d=re.value;return!n||!d?"0px":`${(d.start.time.valueOf()-n.a.valueOf())/(Ee*15)*(Nt/2)+42}px`}),k=m(()=>{const n=ce.value,d=Se.value,b=Ne.value,S=Ve.value;return{left:b,width:n,height:d,top:S}}),j=m(()=>ae.value&&!!f.value),w=m(()=>{const n=Y.value;if(n.length===0)return[-1/0,1/0];const d=n[0].toLocalNativeDate().valueOf(),b=n[n.length-1];let S=b.day;b.time.valueOf()>b.time.shift({minutes:30}).valueOf()&&(S=S.append({day:1}));const t=new H(S,b.time.shift({minutes:30})).toLocalNativeDate().valueOf();return[d,t]}),A=m(()=>{const n=y.value.valueOf(),[d,b]=w.value;return`${At(n,d,b).toFixed(2)}%`}),o=m(()=>{const n=te.value,[d,b]=w.value;return Bt(n,d,b)}),g=()=>{I.value=!1,f.value=null,F.value=!1},P=()=>{const n=le.value,d=re.value,b=J.value;if(!n||!d)return;const S=new Date(d.end.time.valueOf()+Ee*15),t=new H(we.fromLocalNativeDate(S),fe.fromLocalNativeDate(S)),_={...d,end:{...d.end,time:t}};E("add",{horizontal:n,vertical:_,tables:b}),f.value=null,I.value=!1};let X=null;const K=()=>{X&&clearTimeout(X),X=null},ve=n=>{if(K(),!ae.value)return;const d=n.target,b=d.getAttribute("data-col"),S=d.getAttribute("data-time");!b||!S||F.value||(X=setTimeout(()=>{const t={column:b,time:H.fromString(S)};f.value={start:t,end:t},I.value=!1,F.value=!0},500))},C=()=>{const n=f.value,d={};if(n){const b=J.value,S=Object.keys(b),{start:t,end:_}=n;let v=!1;for(let O=0;O<S.length;O++){const z=b[S[O]];if(!v&&z.id===t.column&&(v=!0),v&&(d[z.id]=!0,z.id===_.column))break}E("freez",{time:n.start.time,tables:Object.keys(d)})}};ye(()=>x.freezLoading,(n,d)=>{!n&&d&&g()});const M=n=>{if(F.value){K();const d=n.target,b=d.getAttribute("data-col"),S=d.getAttribute("data-time");if(!b||!S)return;n.preventDefault(),n.stopPropagation();const t={column:b,time:H.fromString(S)};f.value={...f.value,end:t},F.value=!1,I.value=!0}};return ye(ae,(n,d,b)=>{b(()=>{document.removeEventListener("pointerup",K),document.removeEventListener("pointercancel",K)}),n&&(document.addEventListener("pointerup",K),document.addEventListener("pointercancel",K))},{immediate:!0}),(n,d)=>(l(),u("div",{ref_key:"timesheetRef",ref:N,class:r(n.$style.timesheet),"data-show-hidden":F.value},[s("div",Ua,[(l(!0),u(T,null,ie(se.value,(b,S)=>(l(),u("p",{key:S,class:r(n.$style.time)},L(b.a.time),3))),128))]),(l(!0),u(T,null,ie(e(G),(b,S)=>(l(),u("div",{key:b.id},[s("div",{class:r(n.$style.label)},[s("div",{class:r(n.$style.label__content)},[S===0?(l(),u("div",{key:0,ref_for:!0,ref_key:"columnRef",ref:ee},null,512)):B("",!0),st(n.$slots,"xlabel",{item:b})],2)],2),s("div",{class:r(n.$style.content),onContextmenu:d[0]||(d[0]=mt(()=>{},["prevent"])),onPointerdown:ve,onClick:M},[(l(!0),u(T,null,ie(se.value,(t,_)=>(l(),u("div",{key:_,class:r(n.$style.cell)},[s("p",{"data-col":b.id,"data-time":t.a,class:r(n.$style.cell__book)},L(t.a.time),11,Xa),s("p",{"data-col":b.id,"data-time":t.b,class:r(n.$style.cell__book)},L(t.b.time),11,Ra)],2))),128)),(l(!0),u(T,null,ie(o.value[S],(t,_)=>(l(),u("div",{key:`${S}_${_}`,class:r(n.$style.bubble),style:Ue(t.style),"data-id":t.original.full.id,"data-high":`${t.original.full.id}`===n.highlight,"data-type":t.original.type,"data-selection":j.value,"data-airesto":t.original.airesto,onClick:v=>E("show",t.original)},[s("div",{class:r(n.$style.bubble__content)},[st(n.$slots,"default",{item:t.original})],2)],14,qa))),128))],34)]))),128)),j.value?(l(),u("div",{key:0,class:r(n.$style.selection),style:Ue(k.value)},[F.value?(l(),u("div",{key:1,class:r(["ark-text_body-xs",n.$style.dblclick])},[Ha,s("div",{class:r(n.$style.dblclick__btn)},[c(e(W),{"icon-button":"",size:"xs",appearance:"flat",icon:"close",onClick:g})],2),c(e(W),{size:"xs",class:"ark-space_top-1",style:{"pointer-events":"auto"},loading:n.freezLoading,onClick:C},{default:$(()=>[h(" Резерв 15мин ")]),_:1},8,["loading"])],2)):(l(),pe(Ut,{key:0,vertical:re.value,horizontal:le.value,tables:J.value,time:y.value,conf:!!I.value},null,8,["vertical","horizontal","tables","time","conf"])),I.value?(l(),u("div",{key:2,class:r(n.$style.selection__btn)},[c(e(W),{size:"xs",loading:n.freezLoading,onClick:C},{default:$(()=>[h(" Резерв 15мин ")]),_:1},8,["loading"]),c(e(W),{size:"xs",style:{background:"var(--supra-accent)"},onClick:P},{default:$(()=>[h(" Создать ")]),_:1}),c(e(W),{size:"xs",appearance:"neutral",onClick:g},{default:$(()=>[h(" Отменить ")]),_:1})],2)):B("",!0)],6)):B("",!0)],10,Pa))}}),Ja="_timesheet_1yg1j_1",Za="_time_1yg1j_1",Wa="_label_1yg1j_23",Ga="_label__content_1yg1j_36",Ka="_cell_1yg1j_43",Ya="_cell__book_1yg1j_60",Qa="_content_1yg1j_75",es="_bubble_1yg1j_81",ts="_bubble__content_1yg1j_139",as="_slide_1yg1j_151",ss="_selection_1yg1j_169",ns="_selection__btn_1yg1j_182",ls="_dblclick_1yg1j_196",os="_dblclick__btn_1yg1j_204",rs={timesheet:Ja,time:Za,label:Wa,label__content:Ga,cell:Ka,cell__book:Ya,content:Qa,bubble:es,bubble__content:ts,slide:as,selection:ss,selection__btn:ns,dblclick:ls,dblclick__btn:os},is={$style:rs},Xt=Be(Fa,[["__cssModules",is]]),us={style:{isolation:"isolate"}},cs=["data-show-hidden"],ds=["data-col","data-time","onPointerdown"],ms=["data-col","data-time","onPointerdown"],_s=["data-id","data-high","data-type","data-selection","data-airesto","onClick"],vs=s("p",null,"Жду следующую",-1),ps=s("p",null,"Масштаб",-1),fs=Ie({__name:"Timesheet",props:{timeSegments:{},tables:{},data:{},highlight:{},mode:{},addEnabled:{type:Boolean},size:{},freezLoading:{type:Boolean}},emits:["add","show","update:size","freez"],setup(ue,{emit:de}){dt(t=>({"4e0daf69":I.value,"14a7db22":o.value,"9fedf078":g.value}));const x=ue,E=de,{timeSegments:Y,data:te,tables:G,mode:V,addEnabled:ae,size:Q}=Ge(x),q=Te(Vt),ee=m(()=>Q.value*32),N=m(()=>ee.value),F=m(()=>N.value/2),I=m(()=>`${ee.value}px`),f=R(null),y=R(!1),D=m(()=>Y.value.reduce((_,v)=>{const O=new Date(v.valueOf()+Ee*15),z=new H(we.fromLocalNativeDate(O),fe.fromLocalNativeDate(O)),ne={a:v,b:z};return _.push(ne),_},[])),se=m(()=>G.value.reduce((_,v,O)=>(_[v.id]=O,_),{})),oe=m(()=>G.value.reduce((_,v)=>(_[v.id]=v,_),{})),J=m(()=>{const t=f.value;if(!t)return null;const{start:_,end:v}=t,O=_.time.valueOf(),z=v.time.valueOf(),ne=Math.abs(O-z)/(Ee*15);return _.time.valueOf()>v.time.valueOf()?{start:v,end:_,diff:ne}:{start:_,end:v,diff:ne}}),re=m(()=>{const t=f.value;if(!t)return null;const{start:_,end:v}=t,O=se.value,z=O[_.column],ne=O[v.column],$e=Math.abs(z-ne);return z<ne?{start:_,end:v,diff:$e}:{start:v,end:_,diff:$e}}),le=m(()=>{const t=re.value;return t?`${(t.diff+1)*N.value}px`:"0px"}),ce=m(()=>{const t=J.value;return t?`${(t.diff+1)*(F.value/2)}px`:"0px"}),Se=m(()=>{const t=re.value,_=se.value;return t?`${_[t.start.column]*N.value}px`:"0px"}),Ne=m(()=>{const t=D.value[0],_=J.value;return!t||!_?"0px":`${(_.start.time.valueOf()-t.a.valueOf())/(Ee*15)*(F.value/2)}px`}),Ve=m(()=>{const t=le.value,_=ce.value,v=Se.value,O=Ne.value;return{left:v,width:t,height:_,top:O}}),k=m(()=>ae.value&&!!f.value),j=m(()=>V.value==="selection"&&!!f.value&&!y.value),w=m(()=>{const t=Y.value;if(t.length===0)return[-1/0,1/0];const _=t[0].toLocalNativeDate().valueOf(),v=t[t.length-1];let O=v.day;v.time.valueOf()>v.time.shift({minutes:30}).valueOf()&&(O=O.append({day:1}));const z=new H(O,v.time.shift({minutes:30})).toLocalNativeDate().valueOf();return[_,z]}),A=m(()=>q.value.native),o=m(()=>{const t=A.value.valueOf(),[_,v]=w.value;return`${At(t,_,v).toFixed(2)}%`}),g=m(()=>`${te.value.length*100}%`),P=m(()=>{const t=te.value,[_,v]=w.value;return Bt(t,_,v)}),X=t=>{E("update:size",rt(x.size+t,1,6))},K=()=>{const t=re.value,_=J.value,v=oe.value;if(!t||!_)return;const O=new Date(_.end.time.valueOf()+Ee*15),z=new H(we.fromLocalNativeDate(O),fe.fromLocalNativeDate(O)),ne={..._,end:{..._.end,time:z}};E("add",{horizontal:t,vertical:ne,tables:v}),f.value=null,y.value=!1},ve=t=>{t.animationName==="arkVibe"&&t.target&&t.target.classList.remove("ark-vibe")},C=R(!1),M=()=>{const t=f.value,_={};if(t){const v=oe.value,O=Object.keys(v),{start:z,end:ne}=t;let $e=!1;for(let je=0;je<O.length;je++){const Pe=v[O[je]];if(!$e&&Pe.id===z.column&&($e=!0),$e&&(_[Pe.id]=!0,Pe.id===ne.column))break}E("freez",{time:t.start.time,tables:Object.keys(_)})}},n=()=>{y.value=!1,f.value=null,C.value=!1};ye(()=>x.freezLoading,(t,_)=>{!t&&_&&n()});const d=(t,{id:_},v)=>{if(V.value!=="selection"||!ae.value)return;const O={column:_,time:v};y.value=!1,f.value={start:O,end:O}},b=t=>{const _=t.target,v=_.getAttribute("data-col"),O=_.getAttribute("data-time"),z=f.value;if(!v||!O||!z||z.end.time.toString()===O&&z.end.column===v)return;const ne={column:v,time:H.fromString(O)};f.value={...z,end:ne}},S=()=>{y.value=!0};return ye(j,(t,_,v)=>{v(()=>{document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",S),document.removeEventListener("pointercancel",S)}),t&&(document.addEventListener("pointermove",b),document.addEventListener("pointerup",S),document.addEventListener("pointercancel",S))},{immediate:!0}),(t,_)=>(l(),u("div",us,[s("div",{class:r([t.$style.root,t.$style.top])},[s("div",{class:r([t.$style.labelCell,t.$style.labelCell_hidden])},[(l(!0),u(T,null,ie(e(Y),(v,O)=>(l(),u("p",{key:O},L(v.time),1))),128))],2),(l(!0),u(T,null,ie(e(G),(v,O)=>(l(),u("div",{key:O,class:r([t.$style.col,t.$style.col_tobottom])},[s("div",{class:r(t.$style.colLabel)},[st(t.$slots,"xlabel",{item:v},()=>[h(L(v),1)])],2)],2))),128))],2),s("div",{class:r(t.$style.root),"data-show-hidden":C.value},[s("div",{class:r(t.$style.sticky)},[(l(!0),u(T,null,ie(e(Y),(v,O)=>(l(),u("div",{key:O,class:r(t.$style.labelCell)},L(v.time),3))),128))],2),(l(!0),u(T,null,ie(e(G),(v,O)=>(l(),u("div",{key:O,class:r([t.$style.col,O===0&&t.$style.col_first])},[(l(!0),u(T,null,ie(D.value,(z,ne)=>(l(),u("div",{key:ne,class:r(t.$style.cell)},[s("p",{"data-col":v.id,"data-time":z.a,class:r(t.$style.cell__book),onPointerdown:$e=>d($e,v,z.a)},[s("span",{class:r(t.$style.cell__book__text)},L(z.a.time),3)],42,ds),s("p",{"data-col":v.id,"data-time":z.b,class:r(t.$style.cell__book),onPointerdown:$e=>d($e,v,z.b)},[s("span",{class:r(t.$style.cell__book__text)},L(z.b.time),3)],42,ms)],2))),128)),(l(!0),u(T,null,ie(P.value[O],(z,ne)=>(l(),u("div",{key:`${O}_${ne}`,class:r(t.$style.bubble),style:Ue(z.style),"data-id":z.original.full.id,"data-high":`${z.original.full.id}`===t.highlight,"data-type":z.original.type,"data-selection":k.value,"data-airesto":z.original.airesto,onClick:$e=>E("show",z.original),onAnimationend:ve},[s("div",{class:r(t.$style.bubble__content)},[st(t.$slots,"default",{item:z.original})],2)],46,_s))),128))],2))),128)),k.value?(l(),u("div",{key:0,class:r(t.$style.selection),style:Ue(Ve.value)},[C.value?(l(),u("div",{key:1,class:r(["ark-text_body-xs",t.$style.dblclick])},[vs,s("div",{class:r(t.$style.dblclick__btn)},[c(e(W),{"icon-button":"",size:"xs",appearance:"flat",icon:"close",onClick:n})],2)],2)):(l(),pe(Ut,{key:0,vertical:J.value,horizontal:re.value,tables:oe.value,time:A.value,conf:y.value},null,8,["vertical","horizontal","tables","time","conf"])),y.value?(l(),u("div",{key:2,class:r(t.$style.selection__btn)},[c(e(W),{size:"xs",loading:t.freezLoading,onClick:M},{default:$(()=>[h(" Резерв 15мин ")]),_:1},8,["loading"]),c(e(W),{size:"xs",style:{background:"var(--supra-accent)"},onClick:K},{default:$(()=>[h(" Создать ")]),_:1}),c(e(W),{size:"xs",appearance:"neutral",onClick:n},{default:$(()=>[h(" Отменить ")]),_:1})],2)):B("",!0)],6)):B("",!0)],10,cs),s("div",{class:r(t.$style.fixed),onClick:n},[k.value?(l(),pe(e(W),{key:0,appearance:"accent",size:"s"},{default:$(()=>[h(" Отменить создание ")]),_:1})):B("",!0),s("div",{class:r(["ark-space_left-auto",t.$style.size])},[ps,c(e(W),{"icon-button":"",appearance:"flat",size:"xs",icon:"minus",onClick:_[0]||(_[0]=v=>X(-.5))}),c(e(W),{"icon-button":"",appearance:"flat",size:"xs",icon:"plus",onClick:_[1]||(_[1]=v=>X(.5))})],2)],2)]))}}),bs="_root_1v97l_1",ys="_col_1v97l_14",gs="_col_first_1v97l_22",ks="_col_tobottom_1v97l_34",hs="_labelCell_1v97l_40",$s="_labelCell_hidden_1v97l_48",xs="_cell_1v97l_57",ws="_cell__book_1v97l_67",Ss="_cell__book__text_1v97l_75",Os="_selection_1v97l_84",zs="_selection__btn_1v97l_97",Cs="_colLabel_1v97l_111",Ts="_bubble_1v97l_117",Ns="_bubble__content_1v97l_178",Ds="_top_1v97l_196",Ls="_sticky_1v97l_203",Es="_size_1v97l_209",Ms="_dblclick_1v97l_219",Vs="_dblclick__btn_1v97l_224",Is="_fixed_1v97l_231",js={root:bs,col:ys,col_first:gs,col_tobottom:ks,labelCell:hs,labelCell_hidden:$s,cell:xs,cell__book:ws,cell__book__text:Ss,selection:Os,selection__btn:zs,colLabel:Cs,bubble:Ts,bubble__content:Ns,top:Ds,sticky:Ls,size:Es,dblclick:Ms,dblclick__btn:Vs,fixed:Is},As={$style:js},Bs=Be(fs,[["__cssModules",As]]);function Ps(ue){ue.dispatchEvent(new CustomEvent(Kt,{detail:ue,bubbles:!0}))}const Us={mounted:Ps},Xs=s("h6",{class:"ark-text_h6 ark-space_bottom-3"},"Новое бронирование",-1),Rs=s("p",{class:"ark-text_body-s ark-text_64"},"Дата",-1),qs={class:"ark-space_bottom-4"},Hs=s("p",{class:"ark-text_body-s ark-text_64"},"Время начала",-1),Fs=["data-warning"],Js=s("span",{class:"ark-space_top-4"},"—",-1),Zs=s("p",{class:"ark-text_body-s ark-text_64"},"Время конца брони",-1),Ws=["data-warning"],Gs={class:"ark-text_body-xs ark-space_top-1 ark-space_bottom-1 ark-text_64"},Ks={class:"ark-text_semibold"},Ys=s("p",{class:"ark-space_top-2"},[h(" Столы "),s("span",{class:"ark-text_body-xs ark-text_64"}," (можешь добавить нужный или убрать все) ")],-1),Qs=["data-active","onClick"],en={class:"ark-text_body-xs ark-space_top-1 ark-space_bottom-4 ark-text_64"},tn={class:"ark-text_semibold"},an=s("p",{class:"ark-text_body-l ark-text_semibold ark-space_bottom-2"}," Контактные данные ",-1),sn=Ie({__name:"BookingWithTables",props:{item:{},restaurant:{}},emits:["close","add"],setup(ue,{emit:de}){const x=ue,E=de,{item:Y,restaurant:te}=Ge(x),G=_t(),V=vt();class ae{constructor(g,P){this.label=g,this.time_ms=P}toString(){return this.label}}const Q=[new ae("До след брони",-1),new ae("на 2ч",Fe*2),new ae("на 2ч 30м",Fe*2+Ee*30),new ae("на 3ч",Fe*3),new ae("на 4ч",Fe*4)],q=Pt({count:[2,{required:at}],name:["",{required:at}],phone:["",{required:at,phone:fa(!0)}],comment:[""]}),ee=Te(nt),N=Te(It),F=q.count.value,I=Ye({}),f=R(!1),y=R(x.item),D=m(()=>{var P;const o=(P=ee.value)==null?void 0:P.timezone,g=new Date(new Date().toLocaleString("en",{timeZone:o})).toISOString();return H.jsonParse(g)}),se=m(()=>{const o=y.value.horizontal;return o?o.start.column:null}),oe=m(()=>Object.keys(I).filter(o=>I[o]).length>0),J=m(()=>{const o=y.value.tables;return Object.keys(I).reduce((g,P)=>g+(I[P]?o[P].capacity:0),0)}),re=m(()=>J.value<F.value&&oe.value?{capacity:"Столы не вмещают всех"}:null),le=m(()=>{const o=y.value.vertical;if(!o)return null;const{start:g,end:P}=o,X=g.time.valueOf();let K=P.time.valueOf();return K<X&&(K+=Mt),fe.fromAbsoluteMilliseconds(K-X)}),ce=m(()=>{const o=le.value;return o&&o.hours===0&&o.minutes===15}),Se=["час","часа","часов"],Ne=m(()=>{const o=le.value;if(!o)return"";const g=[];return o.hours!==0&&g.push(`${o.hours} ${Lt(Se,o.hours)}`),o.minutes!==0&&g.push(`${o.minutes} мин`),g.join(Et)}),Ve=o=>{const g=y.value;if(o.time_ms===-1){const P=g.vertical.start.time.valueOf(),X=Object.keys(I).reduce((M,n)=>(I[n]&&g.tables[n]&&g.tables[n].reservations.forEach(b=>{const[S,t]=b.seating_time.split("T"),_=new H(we.jsonParse(S),fe.fromString(t)).valueOf();_>P&&M.push(_)}),M),[]);if(X.length===0)return;const K=Math.min(...X),ve=new Date(K),C=new H(we.fromLocalNativeDate(ve),fe.fromLocalNativeDate(ve));y.value={...g,vertical:{...g.vertical,end:{...g.vertical.end,time:C}}}}else{const P=new Date(g.vertical.start.time.valueOf()+o.time_ms),X=new H(we.fromLocalNativeDate(P),fe.fromLocalNativeDate(P));y.value={...g,vertical:{...g.vertical,end:{...g.vertical.end,time:X}}}}},k=o=>{const g=y.value;y.value={...g,vertical:{...g.vertical,start:{...g.vertical.start,time:o}}}},j=o=>{const g=y.value;y.value={...g,vertical:{...g.vertical,end:{...g.vertical.end,time:o}}}},w=({day:o,time:g})=>`${o.toJSON()} ${g.toString("HH:MM")}`,A=()=>{if(q.validate(),q.invalid.value)return;const{start:o,end:g}=y.value.vertical,{phone:P,name:X,count:K,comment:ve}=q.getCurrentValue(),C=Object.keys(I).filter(M=>I[M]);f.value=!0,G.createBooking.execute({restaurant:Number(te.value),tables:C.length===0?void 0:C,num_people:K,name_for_reservation:X,phone_number:`+${Qt(P)}`,comment:ve,seating_time:w(o.time),end_time:w(g.time)}).then(M=>{M&&(V.show(ea(xa),{autoClose:15e3,data:{...M,allTables:N.value,__newbooking:!0}}),E("add",M),E("close"))}).catch(([M])=>{V.show(M.error??"Не удалось создать бронь",{type:"error",label:"Ошибка"})}).finally(()=>{f.value=!1})};return ye(Y,o=>{const g=o.horizontal,P=o.tables,X=Object.keys(P);if(y.value=o,g){const{start:K,end:ve}=g;let C=!1;for(let M=0;M<X.length;M++){const n=P[X[M]];if(!C&&n.id===K.column&&(C=!0),C&&(I[n.id]=!0,n.id===ve.column))break}}q.count.setValue(J.value)},{immediate:!0}),(o,g)=>{var P,X,K,ve;return l(),u(T,null,[Xs,Rs,s("div",{class:r(["ark-space_bottom-2",o.$style.inline])},[c(e(qe),{name:"calendar",size:16}),c(e(We),{today:"",mask:"[day:numeric] [month:long] [year:numeric], [weekday:long]",date:y.value.vertical.start.time.toJSON()},null,8,["date"])],2),s("div",qs,[s("div",{class:r(o.$style.time)},[s("div",{class:r(o.$style.time__item)},[Hs,s("button",{type:"button",class:r(o.$style.time__content),"data-warning":ce.value},[s("div",{class:r(o.$style.inline)},[c(e(qe),{name:"clock",size:16}),c(e(We),{mask:"с [hour:numeric]:[minute:numeric]",date:y.value.vertical.start.time.toJSON()},null,8,["date"]),s("span",null," ‐ "+L(y.value.vertical.start.time.time.shift({minutes:15})),1)],2),c(e(qe),{name:"arrow-right",size:16}),c(e(wt),{"model-value":y.value.vertical.start.time,class:r(o.$style.selectTime),start:(P=e(ee))==null?void 0:P.opening_time,end:(X=e(ee))==null?void 0:X.closing_time,day:y.value.horizontal.start.time.day,min:D.value,"onUpdate:modelValue":k},null,8,["model-value","class","start","end","day","min"])],10,Fs)],2),Js,s("div",{class:r(o.$style.time__item)},[Zs,s("button",{type:"button",class:r(o.$style.time__content),"data-warning":ce.value},[s("div",{class:r(o.$style.inline)},[c(e(qe),{name:"clock",size:16}),c(e(We),{mask:"до [hour:numeric]:[minute:numeric]",date:y.value.vertical.end.time.toJSON()},null,8,["date"])],2),c(e(qe),{name:"arrow-right",size:16}),c(e(wt),{"model-value":y.value.vertical.end.time,class:r(o.$style.selectTime),start:(K=e(ee))==null?void 0:K.opening_time,day:y.value.horizontal.start.time.day,end:(ve=e(ee))==null?void 0:ve.closing_time,min:y.value.horizontal.start.time,"onUpdate:modelValue":j},null,8,["model-value","class","start","day","end","min"])],10,Ws)],2)],2),ce.value?(l(),u("span",{key:0,class:r(["ark-text_body-xs ark-text_semibold",o.$style.error])},[c(e(qe),{name:"warning",size:16}),h(" Слишком мальнькая длительность ")],2)):B("",!0),s("p",Gs,[h(" Длительность "),s("span",Ks,L(Ne.value),1)]),s("div",{class:r(o.$style.buttons)},[(l(),u(T,null,ie(Q,C=>c(e(W),{key:C.label,appearance:"neutral",size:"xs",onClick:M=>Ve(C)},{default:$(()=>[h(L(C),1)]),_:2},1032,["onClick"])),64))],2)]),Ys,c(e(Yt),null,{default:$(()=>[it((l(),u("div",{class:r(["ark-space_bottom-1",o.$style.tables])},[(l(!0),u(T,null,ie(e(Y).tables,(C,M)=>it((l(),u("button",{key:M,type:"button",class:r(o.$style.tables__item),"data-active":I[M],onClick:n=>I[M]=!I[M]},[c(e(jt),{item:C},null,8,["item"])],10,Qs)),[[e($a),se.value===M]])),128))],2)),[[e(ka)],[e(Us)],[e(ha)]])]),_:1}),s("p",en,[oe.value?(l(),u(T,{key:0},[h(" Вместимость "),s("span",tn,L(J.value)+" чел",1)],64)):(l(),u(T,{key:1},[h(" Столы определим сами ")],64))]),an,s("form",{onSubmit:mt(A,["prevent"])},[c(e(Ze),{class:"ark-space_bottom-3",control:e(q).name},{default:$(({model:C})=>[c(e(St),{modelValue:C.value,"onUpdate:modelValue":M=>C.value=M,required:"",label:"На чье имя","has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),c(e(Ze),{class:"ark-space_bottom-3",control:e(q).count},{default:$(({model:C})=>[c(e(ya),{modelValue:C.value,"onUpdate:modelValue":M=>C.value=M,required:"",label:"Кол-во человек",min:1,"has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue"]),c(e(ba),{error:re.value},null,8,["error"])]),_:1},8,["control"]),c(e(Ze),{class:"ark-space_bottom-3",control:e(q).phone},{default:$(({model:C})=>[c(e(ga),{modelValue:C.value,"onUpdate:modelValue":M=>C.value=M,required:"",label:"Номер телефона","has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),c(e(Ze),{class:"ark-space_bottom-6",control:e(q).comment},{default:$(({model:C})=>[c(e(St),{modelValue:C.value,"onUpdate:modelValue":M=>C.value=M,label:"Комментарий","has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),s("div",{class:r(o.$style.actions)},[c(e(W),{type:"submit",loading:f.value},{default:$(()=>[h("Создать")]),_:1},8,["loading"]),c(e(W),{appearance:"neutral",type:"button",onClick:g[0]||(g[0]=C=>E("close"))},{default:$(()=>[h(" Отменить ")]),_:1})],2)],32)],64)}}}),nn="_actions_1yu47_1",ln="_time_1yu47_10",on="_time__item_1yu47_15",rn="_time__content_1yu47_18",un="_inline_1yu47_55",cn="_buttons_1yu47_63",dn="_tables_1yu47_69",mn="_tables__item_1yu47_83",_n="_selectTime_1yu47_115",vn="_error_1yu47_124",pn={actions:nn,time:ln,time__item:on,time__content:rn,inline:un,buttons:cn,tables:dn,tables__item:mn,selectTime:_n,error:vn},fn={$style:pn},bn=Be(sn,[["__cssModules",fn]]),yn=["data-cancelled"],gn={style:{"white-space":"nowrap"}},kn={class:"ark-text_semibold"},hn=Ie({__name:"BubblePreview",props:{item:{}},setup(ue){const de=ue,{item:x}=Ge(de),E=m(()=>{const V=x.value;return`${V.start.time.toString("HH:MM")}-${V.end.time.toString("HH:MM")}`}),Y=m(()=>{const ae=x.value.full.phone_number;return ae?ae.slice(ae.length-4):""}),te=m(()=>{const V=x.value.full;switch(V.status){case Me.APPLICATION:case Me.CANCELLED:case Me.CANCELLED_NO_DEPOSIT:case Me.CLOSED:case Me.NEW:case Me.OPEN:case Me.WAITING:return""}return V.status}),G=m(()=>{const V=x.value.full;return V.status===Me.CANCELLED||V.status===Me.CANCELLED_NO_DEPOSIT});return(V,ae)=>(l(),u("div",{class:r(V.$style.preview),"data-cancelled":G.value},[e(x).type==="reservation"?(l(),u(T,{key:0},[s("div",null,[s("p",{class:r(["ark-space_right-1",V.$style.id])},"№"+L(e(x).full.id),3),s("span",{class:r(V.$style.bold)},L(e(x).full.name_for_reservation),3),s("span",{class:r(V.$style.bold)},L(e(x).full.num_people),3),s("p",gn,L(te.value),1)]),e(x).airesto?(l(),pe(e(ta),{key:0,size:"xs",end_time:e(x).full.end_time,seating_time:e(x).full.seating_time,status:e(x).full.status},null,8,["end_time","seating_time","status"])):B("",!0),e(x).full.phone_number?(l(),u("p",{key:1,class:r(V.$style.phone)},[c(e(aa),{name:"phone",class:r(V.$style.phone)},null,8,["class"]),h(" "+L(Y.value),1)],2)):B("",!0),s("p",null,L(E.value),1)],64)):(l(),u(T,{key:1},[s("p",kn,[e(x).full.status!=="Banquet"?(l(),u(T,{key:0},[h(" Заказ ")],64)):B("",!0),c(e(_a),{class:r(V.$style.status),status:e(x).full.status},null,8,["class","status"])]),s("p",null,L(E.value),1)],64))],10,yn))}}),$n="_id_f0ecp_2",xn="_preview_f0ecp_7",wn="_phone_f0ecp_15",Sn="_bold_f0ecp_19",On="_status_f0ecp_32",zn={id:$n,preview:xn,phone:wn,bold:Sn,status:On},Cn={$style:zn},ct=Be(hn,[["__cssModules",Cn]]),Tn={style:{position:"relative",overflow:"hidden"}},Nn=["data-selected","data-reserved","onClick"],Dn={key:0,style:{"white-space":"nowrap"}},Ln=["src"],En={key:0,style:{"white-space":"nowrap"}},Mn=Ie({__name:"BookingMap",props:{slots:{},prep:{},segments:{},freezLoading:{type:Boolean}},emits:["show","freez"],setup(ue,{emit:de}){const x=ue,E=de,{slots:Y,segments:te}=Ge(x),G=Te(It),V=Te(pt),ae=Te(nt),Q=R(null),q=m(()=>{const k=V.value.daytime.valueOf()-Fe;return te.value.filter(j=>j.valueOf()>=k)}),ee=m(()=>{const k=G.value;return Array.from(Object.values(k).reduce((j,w)=>(j.add(w.zone),j),new Set)).sort()}),N=m(()=>{const k=Y.value,j=V.value.daytime,w=j.valueOf();return k.reduce((A,o)=>{const{orders:g,reservations:P}=o,X=P.sort((n,d)=>new Date(n.seating_time).valueOf()-new Date(d.seating_time).valueOf());let K=null;for(let n=g.length-1;n>=0;n--){const d=g[n];if(d.status==="New"||d.status==="Bill"){K=d.end_time??d.prediction_time;break}}const ve=[];let C=null;for(let n=0;n<X.length;n++){const d=X[n];if(d.status===He.Reserve)continue;const b=we.jsonParse(d.seating_time),S=new H(we.jsonParse(d.seating_time),fe.fromString(d.seating_time.split("T")[1])).valueOf(),t=new H(we.jsonParse(d.end_time),fe.fromString(d.end_time.split("T")[1])).valueOf();if(j.day.daySame(b)&&(S<=w&&w<t&&ve.push(d),w<S)){C=d;break}}const M=ve.reduce((n,d)=>(d.end_time&&n.push({nat:d.end_time,val:new H(we.jsonParse(d.end_time),fe.fromString(d.end_time.split("T")[1])).valueOf()}),n),[]).sort((n,d)=>d.val.valueOf()-n.val.valueOf())[0];return A[o.id]={reserved:!!K||ve.length>0,seating:K??(M==null?void 0:M.nat),nextBooking:C??null},A},{})}),F=m(()=>ee.value.filter(Boolean));ye(F,k=>{k.length>0&&(Q.value=k[0])},{immediate:!0});const I=m(()=>{const k=G.value;return Object.keys(k).reduce((j,w)=>(j[k[w].number]=w,j),{})}),f={"1 Этаж":[[{img:"/romani/sofa_2.png",text:"17",id:"17"},{img:"/romani/sofa_2.png",text:"18",id:"18",style:{transform:"translateX(16px)"}}],[{img:"/romani/round_2.png",text:"19",id:"19",sub:"неброн",style:{transform:"translateX(128px)"}},{img:"/romani/round_2.png",text:"191",id:"191",sub:"неброн",style:{transform:"translateX(144px)"}},{img:"/romani/4.png",text:"14",id:"14",style:{transform:"translate(288px, 8px)"},rotate:{transform:"rotate(90deg)"}}],[],[{img:"/romani/round_5.png",text:"16",id:"16",style:{transform:"translate(32px, -16px)"}},{img:"/romani/4.png",text:"154",id:"154",style:{transform:"translateX(64px)"}},{img:"/romani/4.png",text:"153",id:"153",style:{transform:"translateX(76px)"}},{img:"/romani/4.png",text:"152",id:"152",style:{transform:"translateX(88px)"}},{img:"/romani/6.png",text:"151",id:"151",style:{transform:"translateX(100px)"}},{img:"/romani/round_4.png",text:"15",id:"15",style:{transform:"translateX(128px)"}},{img:"/romani/2.png",text:"12",id:"12",style:{transform:"translate(160px, 8px)"}}],[{img:"/romani/arrow.svg",sub:"Вход",id:"lol?",custom:!0,style:{"margin-left":"-48px"},rotate:{width:"48px",height:"12px"}}],[{img:"/romani/round_5.png",text:"1",id:"1"},{img:"/romani/sofa_1.png",text:"2",id:"2",style:{transform:"translateX(24px)"},rotate:{transform:"rotate(-90deg)"}},{img:"/romani/sofa_2.png",text:"4",id:"4",style:{transform:"translateX(36px)"},rotate:{transform:"rotate(-180deg)"}},{img:"/romani/sofa_1.png",text:"5",id:"5",style:{transform:"translateX(64px)"},rotate:{transform:"rotate(-90deg)"}},{img:"/romani/sofa_2.png",text:"6",id:"6",style:{transform:"translateX(76px)"},rotate:{transform:"rotate(-180deg)"}},{img:"/romani/sofa_2.png",text:"8",id:"8",style:{transform:"translateX(104px)"},rotate:{transform:"rotate(-180deg)"}},{img:"/romani/sofa_1.png",text:"10",id:"10",style:{transform:"translateX(116px)"},rotate:{transform:"rotate(-90deg)"}},{img:"/romani/round_6.png",text:"11",id:"11",style:{transform:"translateX(150px)"},rotate:{transform:"rotate(-90deg)"}}]],"2 Этаж":[[{img:"/romani/2.png",text:"47",id:"47",rotate:{transform:"rotate(90deg)"}},{img:"/romani/2.png",text:"48",id:"48",style:{transform:"translateX(16px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/sofa_5.png",text:"40",id:"40",style:{transform:"translateX(44px)"},rotate:{width:"90px",height:"44px"}},{img:"/romani/2.png",text:"41",id:"41",style:{transform:"translateX(76px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/2.png",text:"42",id:"42",style:{transform:"translateX(88px)"},rotate:{transform:"rotate(90deg)"}}],[],[{img:"/romani/2.png",text:"46",id:"46",rotate:{transform:"rotate(90deg)"}},{img:"/romani/2.png",text:"45",id:"45",style:{transform:"translateX(16px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/2.png",text:"44",id:"44",style:{transform:"translateX(166px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/2.png",text:"43",id:"43",style:{transform:"translateX(178px)"},rotate:{transform:"rotate(90deg)"}}],[],[{img:"/romani/4.png",text:"37",id:"37",style:{transform:"translateX(52px)"}},{img:"/romani/2.png",text:"36",id:"36",style:{transform:"translateX(68px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/4.png",text:"34",id:"34",style:{transform:"translateX(84px)"}},{img:"/romani/2.png",text:"33",id:"33",style:{transform:"translateX(100px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/4.png",text:"31",id:"31",style:{transform:"translateX(116px)"}},{img:"/romani/2.png",text:"21",id:"21",style:{transform:"translateX(132px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/2.png",text:"30",id:"30",style:{transform:"translateX(148px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/round_6.png",text:"20",id:"20",style:{transform:"translateX(196px)"}}],[],[{img:"/romani/round_4.png",text:"29",id:"29",style:{transform:"translateX(36px)"}},{img:"/romani/round_4.png",text:"28",id:"28",style:{transform:"translateX(52px)"}},{img:"/romani/round_2.png",text:"27",id:"27",style:{transform:"translateX(68px)"},rotate:{transform:"rotate(-45deg)"}},{img:"/romani/round_2.png",text:"39",id:"39",style:{transform:"translateX(84px)"},rotate:{transform:"rotate(-45deg)"}},{img:"/romani/round_4.png",text:"26",id:"26",style:{transform:"translateX(100px)"}},{img:"/romani/round_4.png",text:"25",id:"25",style:{transform:"translateX(116px)"}},{img:"/romani/round_2.png",text:"24",id:"24",style:{transform:"translateX(132px)"},rotate:{transform:"rotate(-45deg)"}},{img:"/romani/round_4.png",text:"23",id:"23",style:{transform:"translateX(148px)"}},{img:"/romani/3.png",text:"22",id:"22",style:{transform:"translateX(164px)"}}]],"Банкетный зал":[[{img:"/romani/3.png",text:"61",id:"61",style:{},rotate:{transform:"rotate(90deg)"}},{img:"/romani/4.png",text:"62",id:"62",style:{transform:"translate(16px, 16px)"}},{img:"/romani/2.png",text:"64",id:"64",style:{transform:"translate(32px, 16px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/4.png",text:"65",id:"65",style:{transform:"translate(48px, 16px)"}},{img:"/romani/4.png",text:"67",id:"67",style:{transform:"translate(64px, 16px)"}},{img:"/romani/4.png",text:"69",id:"69",sub:"Не сдвигать",style:{transform:"translate(80px, 16px)"}}],[],[{img:"/romani/arrow.svg",sub:"Вход",id:"lol?",custom:!0,style:{"margin-right":"-48px",transform:"translateY(32px)"},rotate:{width:"48px",height:"12px",transform:"rotate(-90deg)"}},{img:"/romani/4.png",text:"57",id:"57",sub:"Не сдвигать",style:{transform:"translate(48px, 16px)"}},{img:"/romani/4.png",text:"55",id:"55",sub:"Не сдвигать",style:{transform:"translate(64px, 16px)"}},{img:"/romani/4.png",text:"53",id:"53",style:{transform:"translate(80px, 16px)"}},{img:"/romani/2.png",text:"52",id:"52",style:{transform:"translate(96px, 16px)"},rotate:{transform:"rotate(90deg)"}},{img:"/romani/4.png",text:"50",id:"50",sub:"Не сдвигать",style:{transform:"translate(112px, 16px)"}}]]},y=m(()=>{const k=I.value;return Object.keys(f).reduce((j,w)=>(j[w]=f[w].map(A=>A.map(o=>({...o,id:k[o.text]}))),j),{})}),D=Ye({}),se=()=>{var A;const k=Object.keys(D).filter(o=>D[o]);if(k.length===0)return;const j=(A=ae.value)==null?void 0:A.timezone,w=new Date(new Date().toLocaleString("en",{timeZone:j}));E("freez",{tables:k,time:new H(we.fromLocalNativeDate(w),fe.fromLocalNativeDate(w))})},oe=m(()=>Object.keys(D).filter(k=>D[k]).length>0),J=m(()=>{if(!Object.keys(D).filter(A=>D[A]))return{tables:[],data:[]};const j=x.prep;return Y.value.reduce((A,o,g)=>(D[o.id]&&(A.tables.push(o),A.data.push(j[g]??[])),A),{tables:[],data:[]})}),re=k=>{D[k]=!D[k]},le=R({scale:1,translate:{x:0,y:0},deg:0}),ce=m(()=>{const k=le.value;return{position:"relative",display:"inline-flex",transition:"",transformOrigin:"0 0",transform:`translate(${k.translate.x}px, ${k.translate.y}px) scale(${k.scale})`}}),Se=([k,j])=>{const w=le.value.translate;le.value={...le.value,translate:{x:w.x+k,y:w.y+j}}},Ne={matrix:le,onEvent:(k,j,w)=>{const A=le.value;le.value={...A,scale:k,translate:{x:j,y:w}}},onRelease:()=>{}},Ve={onEvent:Se,onPanning:()=>{}};return(k,j)=>(l(),u(T,null,[s("div",{class:r(["ark-space_bottom-2",k.$style.zones])},[(l(!0),u(T,null,ie(F.value,(w,A)=>(l(),pe(e(W),{key:A,size:"xs",type:"button",appearance:Q.value===w?"primary":"neutral",onClick:o=>Q.value=w},{default:$(()=>[h(L(w),1)]),_:2},1032,["appearance","onClick"]))),128))],2),s("div",Tn,[it((l(),u("div",{class:r(k.$style.floor)},[s("div",{class:r(k.$style.content),style:Ue(ce.value)},[(l(!0),u(T,null,ie(y.value[Q.value??"1 Этаж"],(w,A)=>(l(),u("div",{key:A,class:r(k.$style.line)},[(l(!0),u(T,null,ie(w,o=>{var g;return l(),u("button",{key:o.id,type:"button",class:r(k.$style.table),style:Ue(o.style),"data-selected":D[o.id],"data-reserved":(g=N.value[o.id])==null?void 0:g.reserved,onClick:P=>re(o.custom?"":o.id)},[N.value[o.id]?(l(),u("div",{key:0,class:r([k.$style.sub,k.$style.sub_top])},[N.value[o.id].seating?(l(),u("p",Dn,[h(" До "),c(e(We),{mask:"[hour:numeric]:[minute:numeric]",date:N.value[o.id].seating},null,8,["date"])])):B("",!0)],2)):B("",!0),s("span",{class:r(k.$style.table__text)},L(o.text),3),s("img",{src:o.img,width:"32",height:"32",style:Ue(o.rotate)},null,12,Ln),o.sub?(l(),u("p",{key:1,class:r(["ark-text_64",k.$style.sub])},L(o.sub),3)):B("",!0),N.value[o.id]?(l(),u("div",{key:2,class:r(k.$style.sub)},[N.value[o.id].nextBooking?(l(),u("p",En,[h(" След в "),c(e(We),{mask:"[hour:numeric]:[minute:numeric]",date:N.value[o.id].nextBooking.seating_time},null,8,["date"])])):B("",!0)],2)):B("",!0)],14,Nn)}),128))],2))),128))],6)],2)),[[e(sa)],[e(wa),Ve],[e(Sa),Ne]]),s("div",{class:r(k.$style.sheet)},[c(e(Xt),{style:{width:"50%"},data:J.value.data,count:1,"time-segments":q.value,tables:J.value.tables,onShow:j[0]||(j[0]=w=>E("show",w))},{default:$(({item:w})=>[c(ct,{item:w},null,8,["item"])]),xlabel:$(({item:w})=>[c(e(ut),{id:w.id},null,8,["id"])]),_:1},8,["data","time-segments","tables"])],2),s("div",{class:r(k.$style.buttons)},[c(e(W),{size:"xs",disabled:!oe.value,onClick:se},{default:$(()=>[h(" Резерв 15мин "),oe.value?B("",!0):(l(),u(T,{key:0},[h("(выбери столы)")],64))]),_:1},8,["disabled"])],2)])],64))}}),Vn="_floor_1w8hb_1",In="_content_1w8hb_10",jn="_line_1w8hb_18",An="_table_1w8hb_24",Bn="_table__text_1w8hb_47",Pn="_sheet_1w8hb_61",Un="_sub_1w8hb_79",Xn="_sub_top_1w8hb_87",Rn="_zones_1w8hb_92",qn="_buttons_1w8hb_98",Hn={floor:Vn,content:In,line:jn,table:An,table__text:Bn,sheet:Pn,sub:Un,sub_top:Xn,zones:Rn,buttons:qn},Fn={$style:Hn},Jn=Be(Mn,[["__cssModules",Fn]]);function Zn(ue,de){const x=document.createElement("a");x.download=ue,x.href=de,x.click()}const Wn=s("h6",{class:"ark-text_h6 ark-space_bottom-6"},"Выгрузка бронирований",-1),Gn={key:0,class:"ark-text_body-xs ark-text_64"},Kn={key:0,class:"ark-text_body-s ark-space_bottom-4"},Yn=["download","href"],Qn=Ie({__name:"DownloadContacts",props:{id:{},defaultDay:{}},setup(ue){const de=ue,x=Pt({start:[de.defaultDay,{required:at}],end:[null]}),E=_t(),Y=vt(),te=Te(pt),G=R(!1),V=R(null),ae=()=>{if(x.validate(),x.invalid.value)return;const{start:Q,end:q}=x.getCurrentValue();G.value=!0,E.guestsContactsExport({restaurant_id:de.id,start_date:Q.toJSON(),end_start:q==null?void 0:q.toJSON()}).then(ee=>{var f;const N=window.URL.createObjectURL(ee),I=Q.daySame(q||te.value.day)?`Брони_гостей_за_${Q.toString()}.xlsx`:`Брони_гостей_с_${Q.toString()}_до_${(f=q||te.value.day)==null?void 0:f.toString()}.xlsx`;V.value={name:I,url:N},Zn(I,N)}).catch(()=>{Y.show("Не удалось скачать выгрузку",{type:"error"})}).finally(()=>{G.value=!1})};return(Q,q)=>(l(),u(T,null,[Wn,s("form",{onSubmit:mt(ae,["prevent"])},[c(e(Ze),{class:"ark-space_bottom-3",control:e(x).start},{default:$(({model:ee})=>[c(e(Tt),{modelValue:ee.value,"onUpdate:modelValue":N=>ee.value=N,required:"",size:"l",label:"Дата начала","has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["control"]),c(e(Ze),{class:"ark-space_bottom-4",control:e(x).end},{default:$(({model:ee})=>{var N;return[c(e(Tt),{modelValue:ee.value,"onUpdate:modelValue":F=>ee.value=F,size:"l",label:"Дата окончания",class:"ark-space_bottom-1","has-cleaner":!1},null,8,["modelValue","onUpdate:modelValue"]),ee.value?B("",!0):(l(),u("p",Gn," По умолчанию текущая дата - "+L((N=e(te))==null?void 0:N.day),1))]}),_:1},8,["control"]),V.value?(l(),u("div",Kn,[h(" Если загрузка не началась автоматически, нажмите сюда "),s("a",{download:V.value.name,href:V.value.url},L(V.value.name),9,Yn)])):B("",!0),c(e(W),{type:"submit",size:"l",style:{width:"100%"},loading:G.value},{default:$(()=>[h(" Выгрузить ")]),_:1},8,["loading"])],32)],64))}}),el="/aairesto/img/selection.gif",tl="/aairesto/img/2clicks.gif",al=s("h6",{class:"ark-text_h6 ark-space_bottom-3"}," Как выбирать столы для бронирования ",-1),sl=s("div",null,[s("p",{class:"ark-text_semibold"},"Выделение"),s("p",{class:"ark-text_body-s"},"Только для компьютеров")],-1),nl=s("div",null,[s("p",{class:"ark-text_semibold"},"Удержание"),s("p",{class:"ark-text_body-s"},"Для телефонов и планшетов")],-1),ll=Ie({__name:"SelectionModeExplan",props:{mode:{}},emits:["update:mode"],setup(ue,{emit:de}){const x=de,E=na();return(Y,te)=>(l(),u(T,null,[al,e(E)?B("",!0):(l(),u(T,{key:0},[c(e(Je),{style:{display:"inline-flex"}},{default:$(()=>[c(e(Ot),{class:"ark-space_right-2",style:{"align-self":"flex-start"},"model-value":Y.mode==="selection","onUpdate:modelValue":te[0]||(te[0]=G=>x("update:mode","selection"))},null,8,["model-value"]),sl]),_:1}),s("img",{src:el,width:"200px",height:"177",class:r(["ark-space_bottom-4",Y.$style.gif])},null,2)],64)),c(e(Je),{style:{display:"inline-flex"}},{default:$(()=>[c(e(Ot),{class:"ark-space_right-2",style:{"align-self":"flex-start"},"model-value":Y.mode==="click","onUpdate:modelValue":te[1]||(te[1]=G=>x("update:mode","click"))},null,8,["model-value"]),nl]),_:1}),s("img",{src:tl,class:r(Y.$style.gif)},null,2)],64))}}),ol="_gif_ncrcy_1",rl={gif:ol},il={$style:rl},ul=Be(ll,[["__cssModules",il]]),cl=s("p",{class:"ark-text_body-s ark-text_medium ark-text_64"},"Когда",-1),dl=["data-active","onClick"],ml=["data-active"],_l=s("p",null,"Как выбирать столы?",-1),vl={class:"ark-text_semibold"},pl=s("p",{class:"ark-text_body-xs ark-text_semibold ark-text_64"}," Shift + колесико мышки для скролла по горизонтали ",-1),fl={key:2},bl=s("p",{class:"ark-text_body-s ark-text_medium ark-text_64"},"Отображаемые зоны",-1),yl=["data-active","onClick"],gl=["data-tablebar"],kl={key:1,class:"ark-text_body-xs"},hl=s("h6",{class:"ark-text_h6"},"Настройки таблицы",-1),$l=s("p",{class:"ark-text_body-xs ark-space_bottom-2 ark-text_64"}," Эти настройки только для вас ",-1),xl={class:"ark-space_bottom-4"},wl={class:"ark-space_bottom-4"},Sl={class:"ark-space_bottom-4"},Ol=Ie({__name:"Booking",props:{id:{}},setup(ue){dt(a=>({"812619ba":C.value}));const de={Banquet:"Банкеты",Bill:"Пречек",Closed:"Закрытые",Deleted:"Удаленные",New:"Новые"},x=He,E=ue,Y=la(),te=_t(),G=vt(),V=ia(),ae=ua(),Q=Oa(),{reservationToShow:q,navItems:ee,tableDate:N,tableSlots:F}=oa(Q),I=R(!1),f=R(!1),y=R(!1),D=R(null),se=R(!1),oe=R(!1),J=R(!1),re=localStorage.getItem("__ark-supra-timesheet-size"),le=Number.isNaN(re)?4:rt(Number(re),1,6),ce=R(le);ye(ce,a=>{localStorage.setItem("__ark-supra-timesheet-size",`${a}`)});const Se=R(null),Ne=Te(pt),Ve=m(()=>{const a=N.value,i=Ne.value.daytime;return i.day.daySame(a)?"Сегодня":i.day.append({day:1}).daySame(a)?"Завтра":a}),k=localStorage.getItem("__ark-supra-selection-mode"),j=ra()==="web"?k==="selection"||k==="click"?k:"selection":"click",w=R(j),A=R(!1);ye(w,a=>{localStorage.setItem("__ark-supra-selection-mode",a)});const o=Te(nt),g=Te(da),P=localStorage.getItem(`__ark-supra-empty-tables-state_${E.id}`),X=R(!P||P==="1");ye(X,a=>{localStorage.setItem(`__ark-supra-empty-tables-state_${E.id}`,a?"1":"0")});function K(a){return typeof a!="string"||!a||Number.isNaN(Number(a))?3:Number(a)}const ve=K(localStorage.getItem(`__ark-supra-mobile-tables-count-state_${E.id}`)),C=R(ve),M=a=>{const i=C.value,U=rt(i+a,1,1/0);C.value=U};ye(C,a=>{localStorage.setItem(`__ark-supra-mobile-tables-count-state_${E.id}`,`${a}`)});function n(a){if(typeof a!="string")return{};let i;try{i=JSON.parse(a)}catch{}return typeof i=="object"&&i!==null?i:{}}const d=n(localStorage.getItem(`__ark-supra-orders-state_${E.id}`)),b=Ye({Banquet:d.Banquet??!0,Bill:d.Bill??!0,Closed:d.Closed??!0,Deleted:d.Deleted??!0,New:d.New??!0});ye(b,a=>{localStorage.setItem(`__ark-supra-orders-state_${E.id}`,JSON.stringify(a))});const S=n(localStorage.getItem(`__ark-supra-reservation-state_v2_${E.id}`)),t=Object.values(Me),_=t.reduce((a,i)=>(a[i]=!0,a),{}),v=Ye(Object.values(He).concat(...t).reduce((a,i)=>(a[i]=S[i]??!0,a),{}));ye(v,a=>{localStorage.setItem(`__ark-supra-reservation-state_v2_${E.id}`,JSON.stringify(a))});const O=n(localStorage.getItem(`__ark-supra-zones-state_${E.id}`)),z=Ye(O);ye(z,a=>{localStorage.setItem(`__ark-supra-zones-state_${E.id}`,JSON.stringify(a))});const ne=Y.computedSmallerThen("mobile"),$e=a=>{Se.value=a},je=(a,i)=>{const U=i[a];return U===void 0?!0:U},Pe=a=>{a.type==="reservation"&&(se.value?(D.value=a,oe.value=!0):V.push({query:{...ae.query,type:a.airesto?void 0:"resto",bookingid:a.full.id}}))},ft=m(()=>g.value.filter(Boolean)),bt=m(()=>ft.value.every(i=>je(i,z))),yt=m(()=>Object.values(v).every(i=>i)),gt=m(()=>Object.values(b).every(i=>i)),Rt=()=>{const a=bt.value,i=ft.value,U=!a;i.forEach(Z=>{z[Z]=U})},qt=()=>{const a=yt.value,i=v,U=!a;Object.keys(i).forEach(Z=>{v[Z]=U})},Ht=a=>{F.value=F.value.map(i=>{if(a.tables.includes(i.id)){const U=i.reservations.concat(a);return{...i,reservations:U}}return i})},Ft=()=>{const a=gt.value,i=b,U=!a;Object.keys(i).forEach(Z=>{b[Z]=U})},lt=m(()=>{var be,ze;const i=N.value,U=(be=o.value)==null?void 0:be.opening_time,Z=(ze=o.value)==null?void 0:ze.closing_time;if(!U||!Z)return[];const ge=fe.fromString(U),Oe=fe.fromString(Z);let ke=i;return ge.toAbsoluteMilliseconds()>Oe.toAbsoluteMilliseconds()&&(ke=ke.append({day:1})),ma(new H(i,ge),new H(ke,Oe),{minutes:30})}),Xe=R(!1),kt=R(!1),ht=m(()=>{const i=Ne.value.day;return new Array(5).fill("").map((U,Z)=>i.append({day:Z}))}),Jt=m(()=>Xe.value?pa:F.value.filter(a=>je(a.zone,z))),$t=m(()=>{if(Xe.value)return[];const a=new Set;return F.value.forEach(i=>{a.add(i.zone)}),Array.from(a).sort()}),Zt=m(()=>{const a=N.value,i=F.value,U=new Array(i.length).fill("").map(()=>null),Z=new Array(i.length).fill("").map(()=>[]);return i.forEach((ge,Oe)=>{U[Oe]=ge;const ke=ge.orders.reduce((Ce,me)=>{var De,he;if(b[me.status]){const _e=me.start_time.split("+")[0],Le=H.jsonParse(_e);if(Le.day.daySame(a)){const p={start:Le,end:H.jsonParse(((De=me.end_time)==null?void 0:De.split("+")[0])??((he=me.prediction_time)==null?void 0:he.split("+")[0])??""),type:me.status,airesto:!1,full:me};Ce.push(p)}}return Ce},[]),be=ge.reservations.reduce((Ce,me)=>{if(v[me.status]&&(E.id!=="111113"||me.status!==He.Reserve)){const De=H.jsonParse(me.seating_time.split("+")[0]);if(De.day.daySame(a)){const he={start:De,end:H.jsonParse(me.end_time.split("+")[0]),type:"reservation",airesto:_[me.status],full:me};Ce.push(he)}}return Ce},[]),ze=[].concat(ke).concat(be);ze.sort((Ce,me)=>Ce.start.toLocalNativeDate().valueOf()-me.start.toLocalNativeDate().valueOf()),Z[Oe]=ze}),{data:Z}}),Ke=m(()=>{const a=N.value,i=Jt.value,U=new Array(i.length).fill("").map(()=>null),Z=new Array(i.length).fill("").map(()=>[]);i.forEach((be,ze)=>{U[ze]=be;const Ce=be.orders.reduce((he,_e)=>{var Le,p;if(b[_e.status]){const xe=_e.start_time.split("+")[0],Ae=H.jsonParse(xe);if(Ae.day.daySame(a)){const Wt={start:Ae,end:H.jsonParse(((Le=_e.end_time)==null?void 0:Le.split("+")[0])??((p=_e.prediction_time)==null?void 0:p.split("+")[0])??""),type:_e.status,airesto:!1,full:_e};he.push(Wt)}}return he},[]),me=be.reservations.reduce((he,_e)=>{if(v[_e.status]&&(E.id!=="111113"||_e.status!==He.Reserve)){const Le=H.jsonParse(_e.seating_time.split("+")[0]);if(Le.day.daySame(a)){const p={start:Le,end:H.jsonParse(_e.end_time.split("+")[0]),type:"reservation",airesto:_[_e.status],full:_e};he.push(p)}}return he},[]),De=[].concat(Ce).concat(me);De.sort((he,_e)=>he.start.toLocalNativeDate().valueOf()-_e.start.toLocalNativeDate().valueOf()),Z[ze]=De});const ge=X.value,Oe=ge?U:U.filter((be,ze)=>Z[ze].length>0),ke=ge?Z:Z.filter(be=>be.length>0);return{tables:Oe,data:ke}}),xt=m(()=>{const a=N.value;return!ht.value.find(i=>i.daySame(a))}),Re=R(null),ot=a=>{y.value=!0;const i=a.tables.length>1;te.reservationFreez.execute({restaurant:Number(E.id),seating_time:`${a.time.day.toJSON()} ${a.time.time.toString("HH:MM")}`,tables:a.tables}).then(U=>{if(U){G.show(`Добавили резерв стол${i?"ов":"а"} на 15 минут`);const Z=new Date(a.time.valueOf()+Fe),ge=new H(we.fromLocalNativeDate(Z),fe.fromLocalNativeDate(Z)),Oe={...U,comment:"",status:He.Sat,queue_number:null,restaurant:Number(E.id),end_time:`${ge.day.toJSON()}T${ge.time.toString("HH:MM")}+10:00`,num_people:1,name_for_reservation:"Новый гость",phone_number:"+79999999999",foreigner:!1,invite_time:null,created:""};F.value=F.value.map(ke=>{if(Oe.tables.includes(ke.id)){const be=ke.reservations.concat(Oe);return{...ke,reservations:be}}return ke})}}).catch(()=>{G.show(`Не удалось зарезервировать стол${i?"ы":""} на 15 мин`,{type:"error"})}).finally(()=>{y.value=!1})};return ye([()=>E.id,N],([a,i])=>{if(!a)return;Re.value=null;const U=i.toJSON();Xe.value=!0,kt.value=!1,te.loadAvailableTables.execute({restaurant_id:a,date:U}).then(Z=>{Z&&(Q.setTableSlots(Z.results),Z.next&&(Re.value={id:a,page:2,date:U}),Xe.value=!1)}).catch(()=>{Re.value=null,Xe.value=!1,kt.value=!0})},{immediate:!0}),ye(Re,a=>{a&&te.loadAvailableTables.execute({restaurant_id:a.id,date:a.date,page:a.page}).then(i=>{i&&(Q.concatTableSlots(i.results),i.next&&(Re.value={id:a.id,date:a.date,page:a.page+1}))}).catch(()=>{Re.value=null,G.show("Не удалось загрузить следующую страницу бронирований",{type:"error"})})},{immediate:!0}),(a,i)=>{var U,Z,ge,Oe,ke,be,ze,Ce,me,De,he,_e,Le;return l(),u(T,null,[s("div",{class:r(a.$style.headerContainer)},[s("h6",{class:r(["ark-text_h6 ark-text_semibold ark-space_top-2 ark-space_bottom-1",a.$style.header])},[h(" Бронирования "),s("div",{class:r(a.$style.statuses)},[c(e(W),{appearance:"neutral",icon:"download",size:"xs",onClick:i[0]||(i[0]=p=>I.value=!I.value)},{default:$(()=>[h(" Контакты гостей ")]),_:1}),c(e(W),{appearance:"neutral",size:"xs",icon:"settings",onClick:i[1]||(i[1]=p=>f.value=!f.value)},{default:$(()=>[h(" Настройки ")]),_:1})],2)],2),s("div",{class:r(["ark-space_bottom-2",a.$style.statuses])},[(U=e(o))!=null&&U.has_bookings?(l(),pe(e(ca),{key:0,size:"s",border:!1,class:r(a.$style.tabs),items:e(ee)},{default:$(({item:p})=>[h(L(p.text),1)]),_:1},8,["class","items"])):B("",!0),!e(ne)&&((Z=e(o))!=null&&Z.has_reservations||(ge=e(o))!=null&&ge.has_bookings)?(l(),pe(e(W),{key:1,size:"xs",icon:"plus",class:"ark-space_top-2 ark-space_left-1",appearance:(Oe=e(o))!=null&&Oe.has_bookings?"accent":void 0,onClick:e(Q).toggleNewBooking},{default:$(()=>[h(" Добавить ")]),_:1},8,["appearance","onClick"])):B("",!0)],2),e(ne)?B("",!0):(l(),u(T,{key:0},[cl,s("div",{class:r(["ark-space_bottom-2",a.$style.statuses])},[(l(!0),u(T,null,ie(ht.value,(p,xe)=>(l(),u("button",{key:p.toJSON(),class:r(a.$style.date),"data-active":p.daySame(e(N)),onClick:Ae=>N.value=p},[c(e(Qe),{class:"ark-text_semibold",mask:"[day:numeric] [month:long]",date:p.toLocalNativeDate()},null,8,["date"]),s("p",null,[xe<2?(l(),u(T,{key:0},[h(L(e(Ne).day.daySame(p)?"сегодня":"завтра"),1)],64)):(l(),pe(e(Qe),{key:1,mask:"[weekday:long]",date:p.toLocalNativeDate()},null,8,["date"]))])],10,dl))),128)),c(e(Ct),{modelValue:J.value,"onUpdate:modelValue":i[3]||(i[3]=p=>J.value=p),align:"left","max-width":243,"min-width":243,"min-height":290},{dropdown:$(()=>[c(e(zt),{value:e(N),onDayClick:i[2]||(i[2]=p=>{N.value=p,J.value=!1})},null,8,["value"])]),default:$(()=>[s("button",{style:{height:"2.5rem"},class:r(a.$style.date),"data-active":xt.value},[xt.value?(l(),u(T,{key:0},[c(e(Qe),{class:"ark-text_semibold",mask:"[day:numeric] [month:long]",date:e(N).toLocalNativeDate()},null,8,["date"]),s("p",null,[c(e(Qe),{mask:"[weekday:long]",date:e(N).toLocalNativeDate()},null,8,["date"])])],64)):(l(),u(T,{key:1},[h(" Выбрать ")],64))],10,ml)]),_:1},8,["modelValue"]),(ke=e(o))!=null&&ke.has_bookings?(l(),u("button",{key:0,type:"button",class:r(["ark-space_left-auto",a.$style.date]),onClick:i[4]||(i[4]=p=>A.value=!A.value)},[_l,s("p",vl,L(w.value==="selection"?"Выделение":"Удержание"),1)],2)):B("",!0)],2),pl],64)),a.id==="111113"?(l(),pe(Jn,{key:1,slots:e(F),prep:Zt.value.data,segments:lt.value,"freez-loading":y.value,onShow:Pe,onFreez:ot},null,8,["slots","prep","segments","freez-loading"])):B("",!0),e(ne)&&((be=e(o))!=null&&be.has_bookings)?(l(),u("div",fl,[s("a",{class:"ark-text_body-s",style:{"text-decoration":"underline"},onClick:i[5]||(i[5]=p=>A.value=!A.value)}," Как выбирать столы для брони? ")])):B("",!0),bl,s("div",{class:r(a.$style.statuses)},[(l(!0),u(T,null,ie($t.value,p=>(l(),pe(e(va),{key:p,a:je(p,z)},{default:$(({a:xe})=>[s("button",{type:"button",class:r([a.$style.date,a.$style.date_center]),"data-active":xe,onClick:Ae=>z[p]=!xe},L(p),11,yl)]),_:2},1032,["a"]))),128))],2)],2),s("div",{class:r(a.$style.container),"data-tablebar":e(q)!==null},[Ke.value.tables.length>0?(l(),u(T,{key:0},[Xe.value?(l(),u(T,{key:1},[c(e(Dt),{name:"spinner",class:"ark-space_right-2",size:16}),h(" Загружаем... ")],64)):(l(),u(T,{key:0},[e(ne)?(l(),pe(e(Xt),{key:1,"time-segments":lt.value,tables:Ke.value.tables,data:Ke.value.data,highlight:(me=e(q))==null?void 0:me.id,count:C.value,"add-enabled":(De=e(o))==null?void 0:De.has_bookings,"freez-loading":y.value,onShow:Pe,onAdd:$e,onFreez:ot},{default:$(({item:p})=>[c(ct,{item:p},null,8,["item"])]),xlabel:$(({item:p})=>[c(e(ut),{id:p.id},null,8,["id"])]),_:1},8,["time-segments","tables","data","highlight","count","add-enabled","freez-loading"])):(l(),pe(e(Bs),{key:0,size:ce.value,"onUpdate:size":i[6]||(i[6]=p=>ce.value=p),"time-segments":lt.value,tables:Ke.value.tables,data:Ke.value.data,highlight:(ze=e(q))==null?void 0:ze.id,mode:e(ne)?"click":w.value,"add-enabled":(Ce=e(o))==null?void 0:Ce.has_bookings,"freez-loading":y.value,onShow:Pe,onAdd:$e,onFreez:ot},{default:$(({item:p})=>[c(ct,{item:p},null,8,["item"])]),xlabel:$(({item:p})=>[ce.value>2?(l(),pe(e(jt),{key:0,item:p},null,8,["item"])):(l(),u("div",kl,[c(e(ut),{id:p.id},null,8,["id"])]))]),_:1},8,["size","time-segments","tables","data","highlight","mode","add-enabled","freez-loading"]))],64))],64)):e(o)?(l(),u(T,{key:1},[h(' Нет данных. Возможно у вас скрытые "пустые" столы в настройках ')],64)):B("",!0)],10,gl),e(ne)?(l(),u("div",{key:0,class:r(a.$style.safe__content)},[c(e(Ct),{modelValue:J.value,"onUpdate:modelValue":i[8]||(i[8]=p=>J.value=p),align:"right",class:"ark-space_left-auto","max-width":243,"min-width":243,"min-height":290},{dropdown:$(()=>[c(e(zt),{value:e(N),onDayClick:i[7]||(i[7]=p=>{N.value=p,J.value=!1})},null,8,["value"])]),default:$(()=>[c(e(W),{icon:"calendar",appearance:"elevation",size:"l",style:{"--ark-padding":"1rem"}},{default:$(()=>[h(L(Ve.value),1)]),_:1})]),_:1},8,["modelValue"]),(he=e(o))!=null&&he.has_reservations||(_e=e(o))!=null&&_e.has_bookings?(l(),pe(e(W),{key:0,"icon-button":"",shape:"square",icon:"plus",size:"l",appearance:(Le=e(o))!=null&&Le.has_bookings?"accent":void 0,onClick:e(Q).toggleNewBooking},null,8,["appearance","onClick"])):B("",!0)],2)):B("",!0),c(e(et),{modelValue:f.value,"onUpdate:modelValue":i[12]||(i[12]=p=>f.value=p),order:4},{default:$(()=>[hl,$l,s("div",xl,[s("div",{class:r(["ark-text_body-xs ark-text_64",a.$style.header])}," Столы ",2),c(e(Je),{class:r(a.$style.label)},{default:$(()=>[h(" Показывать пустые столы "),c(e(tt),{modelValue:X.value,"onUpdate:modelValue":i[9]||(i[9]=p=>X.value=p),size:"s"},null,8,["modelValue"])]),_:1},8,["class"]),e(ne)?(l(),u("div",{key:0,class:r(a.$style.label)},[h(" Отображение кол-ва столов "),s("div",{class:r(a.$style.label__counter)},[c(e(W),{"icon-button":"",shape:"square",appearance:"neutral",size:"xs",icon:"minus",onClick:i[10]||(i[10]=p=>M(-1))}),h(" "+L(C.value)+" ",1),c(e(W),{"icon-button":"",shape:"square",appearance:"neutral",size:"xs",icon:"plus",onClick:i[11]||(i[11]=p=>M(1))})],2)],2)):B("",!0)]),s("div",wl,[s("div",{class:r(["ark-text_body-xs ark-text_64",a.$style.header])},[h(" Бронирования "),c(e(W),{size:"xs",appearance:"flat",onClick:qt},{default:$(()=>[h(L(yt.value?"Скрыть все":"Все"),1)]),_:1})],2),(l(!0),u(T,null,ie(e(x),(p,xe)=>(l(),pe(e(Je),{key:xe,class:r(a.$style.label)},{default:$(()=>[h(L(p)+" ",1),c(e(tt),{modelValue:v[p],"onUpdate:modelValue":Ae=>v[p]=Ae,size:"s"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["class"]))),128))]),s("div",Sl,[s("div",{class:r(["ark-text_body-xs ark-text_64",a.$style.header])},[h(" Заказы "),c(e(W),{size:"xs",appearance:"flat",onClick:Ft},{default:$(()=>[h(L(gt.value?"Скрыть все":"Все"),1)]),_:1})],2),(l(),u(T,null,ie(de,(p,xe)=>c(e(Je),{key:xe,class:r(a.$style.label)},{default:$(()=>[h(L(p)+" ",1),c(e(tt),{modelValue:b[xe],"onUpdate:modelValue":Ae=>b[xe]=Ae,size:"s"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["class"])),64))]),s("div",null,[s("div",{class:r(["ark-text_body-xs ark-text_64",a.$style.header])},[h(" Зоны "),c(e(W),{size:"xs",appearance:"flat",onClick:Rt},{default:$(()=>[h(L(bt.value?"Скрыть все":"Все"),1)]),_:1})],2),(l(!0),u(T,null,ie($t.value,p=>(l(),pe(e(Je),{key:p,class:r(a.$style.label)},{default:$(()=>[h(L(p)+" ",1),c(e(tt),{size:"s","model-value":je(p,z),"onUpdate:modelValue":xe=>z[p]=xe},null,8,["model-value","onUpdate:modelValue"])]),_:2},1032,["class"]))),128))])]),_:1},8,["modelValue"]),c(e(et),{overscroll:"none","model-value":Se.value!==null,"onUpdate:modelValue":i[13]||(i[13]=p=>Se.value=null)},{default:$(({close:p})=>[Se.value?(l(),pe(bn,{key:0,item:Se.value,restaurant:a.id,onAdd:Ht,onClose:p},null,8,["item","restaurant","onClose"])):B("",!0)]),_:1},8,["model-value"]),c(e(et),{modelValue:A.value,"onUpdate:modelValue":i[15]||(i[15]=p=>A.value=p)},{default:$(()=>[c(ul,{mode:w.value,"onUpdate:mode":i[14]||(i[14]=p=>w.value=p)},null,8,["mode"])]),_:1},8,["modelValue"]),c(e(et),{modelValue:I.value,"onUpdate:modelValue":i[16]||(i[16]=p=>I.value=p),size:"sm"},{default:$(()=>[a.id?(l(),pe(Qn,{key:0,id:a.id,"default-day":e(N)},null,8,["id","default-day"])):B("",!0)]),_:1},8,["modelValue"])],64)}}}),zl="_container_42k44_1",Cl="_headerContainer_42k44_8",Tl="_fixed_42k44_15",Nl="_tabs_42k44_39",Dl="_header_42k44_8",Ll="_statuses_42k44_50",El="_buttons_42k44_55",Ml="_statusesScroll_42k44_65",Vl="_date_42k44_80",Il="_date_center_42k44_98",jl="_cell_42k44_107",Al="_input_42k44_112",Bl="_notification_42k44_147",Pl="_label_42k44_153",Ul="_label__counter_42k44_172",Xl="_spinner_42k44_180",Rl="_safe_42k44_196",ql="_safe__content_42k44_199",Hl="_safe__buttons_42k44_210",Fl="_search_42k44_218",Jl="_search_focused_42k44_224",Zl={container:zl,headerContainer:Cl,fixed:Tl,tabs:Nl,header:Dl,statuses:Ll,buttons:El,statusesScroll:Ml,date:Vl,date_center:Il,cell:jl,input:Al,notification:Bl,label:Pl,label__counter:Ul,spinner:Xl,safe:Rl,safe__content:ql,safe__buttons:Hl,search:Fl,search_focused:Jl},Wl={$style:Zl},uo=Be(Ol,[["__cssModules",Wl]]);export{uo as default};
